<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å°å®‹</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-03-30T13:28:52.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>rwson</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>NodeJsè¯»å–windowsæ³¨å†Œè¡¨æ¥å¯¹è½¯ä»¶è¿›è¡Œå¸è½½</title>
    <link href="http://yoursite.com/2017/03/29/2017-03-29-node-read-regedit-uninstall-software/"/>
    <id>http://yoursite.com/2017/03/29/2017-03-29-node-read-regedit-uninstall-software/</id>
    <published>2017-03-28T16:00:00.000Z</published>
    <updated>2017-03-30T13:28:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨åŸºäºnode-webkit(ä»¥ä¸‹ç®€ç§°NW)å¼€å‘windowsæ¡Œé¢app,é‡Œé¢æœ‰ä¸ªç±»ä¼¼äºè½¯ä»¶å¸‚åœºçš„åŠŸèƒ½,åå°ç®¡ç†å‘˜æä¾›ä¸€äº›è½¯ä»¶,å¯ä»¥ä»è¯¥appä¸Šè¿›è¡Œä¸‹è½½ã€å®‰è£…ã€å¸è½½ã€å‡çº§ç­‰ç­‰ã€‚</p>
<p>å®‰è£…æˆ–å‡çº§å¯ä»¥ç›´æ¥é€šè¿‡æŠŠä¸‹è½½å¥½çš„zipåŒ…è§£å‹å‡ºæ¥ç„¶åæ‰§è¡Œé‡Œé¢çš„exeç¨‹åºå®‰è£…å°±å¥½,ä½†æ˜¯å¸è½½ç›¸å¯¹æ¥è¯´æ¯”è¾ƒéº»çƒ¦,å‡ ä¹æ¯ä¸ªç¬¬ä¸‰æ–¹exeåœ¨å®‰è£…åçš„ç›®å½•é‡Œé¢éƒ½æœ‰ä¸€ä¸ªuninstall.exe,ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“è¿™ä¸ªè½¯ä»¶å…·ä½“å®‰è£…åœ¨å“ª,æ‰€ä»¥è¦å¸è½½ä¹Ÿæ— ä»ä¸‹æ‰‹,è¿™æ—¶å€™å°±æƒ³åˆ°äº†æ³¨å†Œè¡¨,é€šè¿‡æ³¨å†Œè¡¨å¯ä»¥è·å–åˆ°æŸä¸ªè½¯ä»¶çš„å®‰è£…ç›®å½•,æ‰€ä»¥å¯ä»¥å…ˆæŠŠå½“å‰æ³¨å†Œè¡¨çš„ç›®å½•å–å¾—,å†å»ç›¸åº”ç›®å½•ä¸‹æ‰¾å¸è½½è¯¥è½¯ä»¶çš„é‚£ä¸ªexeå¹¶æ‰§è¡Œã€‚</p>
<p>ç”±äºNWæ˜¯åŸºäºnodejsçš„,æ‰€ä»¥å¯ä»¥é€šè¿‡ä¸€äº›ç¬¬ä¸‰æ–¹çš„npmåŒ…æ¥æ“ä½œ,åœ¨è¿™é‡Œä¸»è¦ä¸»è¦ç”¨åˆ°çš„åŒ…æ˜¯<a href="https://github.com/fresc81/node-winreg" target="_blank" rel="external">winreg</a>,é¦–å…ˆæˆ‘ä»¬å…ˆåˆ†æä¸‹æ³¨å†Œè¡¨:</p>
<p><img src="/imgs/regedit-nalysis.png" alt="æ³¨å†Œè¡¨åˆ†æ"></p>
<p>å¯ä»¥çœ‹åˆ°æ ¹ä¸‹é¢æœ‰5ä¸ªå¤§é¡¹(HKEY_CLASSES_ROOTã€HKEY_CURRENT_USERã€HKEY_LOCAL_MACHINEã€HKEY_USERSã€HKEY_CURRENT_CONFIG),ç¬¬ä¸‰æ–¹è½¯ä»¶åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨HKEY_LOCAL_MACHINEä¸‹é¢çš„,æ‰€ä»¥è¯»å–çš„æ—¶å€™å°±ä»HKEY_LOCAL_MACHINEä¸‹é¢å¼€å§‹æ‰¾,è¿™é‡Œä»¥æœç‹—è¾“å…¥æ³•ä¸ºä¾‹:</p>
<p><img src="/imgs/sogouinput.png" alt="æœç‹—è¾“å…¥æ³•åˆ†æ"></p>
<p>ä»ä¸Šå›¾ä¸­çœ‹åˆ°è¯¥é¡¹çš„å…¨è·¯å¾„ä¸ºâ€HKEY_LOCAL_MACHINE\SOFTWARE\SogouInputâ€,æ³¨å†Œé¡¹é‡Œçš„ç¬¬ä¸€é¡¹å°±æ˜¯å®‰è£…è·¯å¾„,å¯¹åº”çš„åç§°æ˜¯é»˜è®¤,æ‰€ä»¥æˆ‘ä»¬è¯»å–çš„æ—¶å€™ä»å°±å¯ä»¥è¯»å–åˆšæ‰çš„é‚£ä¸ªè·¯å¾„,ä¸‹é¢æ˜¯ä¸»è¦çš„å®ç°:</p>
<pre><code>const Registry = require(&quot;winreg&quot;),
    child_process = require(&quot;child_process&quot;),
    path = require(&quot;path&quot;),
    key = new Registry({
        //  æ‰“å¼€HKEY_LOCAL_MACHINEè¿™ä¸ªå¤§ç±»
        //  ä¸€å…±æœ‰5ä¸ªå±æ€§,åˆ†åˆ«æ˜¯&apos;HKLM&apos;, &apos;HKCU&apos;, &apos;HKCR&apos;, &apos;HKU&apos;, &apos;HKCC&apos;
        //  å°±æ˜¯ä¸Šé¢é‚£5å¤§é¡¹çš„ç®€ç§°
        hive: Registry.HKLM,
        //  åæ–œæ å‰é¢éœ€è¦åŠ &quot;\&quot;è¿›è¡Œè½¬ä¹‰
        key: &quot;\\SOFTWARE\\SogouInput&quot;
    });

let pre, end, cur, target;

//  è·å–åˆ°æ³¨å†Œé¡¹ä¸­ä¸­æ‰€æœ‰é…ç½®é¡¹,ä»¥é”®å€¼å¯¹çš„å½¢å¼è¿”å›
//  æ¯ä¸€å°é¡¹åˆ†åˆ«åŒ…å«(hostã€hiveã€keyã€nameã€typeã€valueã€arch)è¿™å‡ ä¸ªå±æ€§
key.values((err, res) =&gt; {
    if (err) {
        console.log(err);
    } else {
        for(var i in res) {
            cur = res[i];
            //  åˆ¤æ–­å½“å‰é¡¹çš„åç§°æ˜¯å¦åŒ…å«defaultæˆ–è€…version
            if (/default/gi.test(cur.name)) {
                pre = cur.value;
            } else if (/^version$/gi.test(cur.name)) {
                end = cur.value;
            }
        }

        //  æ‹¼æ¥è½¯ä»¶çš„å®‰è£…å…¨è·¯å¾„
        target = `${pre}\\${end}`;

        //  ç»“åˆnodejsä¸­å­è¿›ç¨‹æ¨¡å—ä¸­çš„execFileæ–¹æ³•æ‰§è¡Œå¸è½½çš„exe
        child_process.execFile(path.join(target, &quot;Uninstall.exe&quot;), (err, res) =&gt; {
            if (err) {
                console.log(&quot;å¸è½½å¤±è´¥,è¯·é‡è¯•!&quot;);
            }
        });
    }
});
</code></pre><p>æœ€åæ‰§è¡Œå†™å¥½çš„jsæ–‡ä»¶,å°±ä¼šé¡ºåˆ©æ‰“å¼€ç›¸å…³å¸è½½çª—å£:</p>
<p><img src="/imgs/uninstall-screenshoot.png" alt="å¸è½½çª—å£"></p>
<p>å½“ç„¶è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„å®ç°,æ˜¯åˆ†æå¥½äº†è½¯ä»¶å®‰è£…ç›®å½•ä¸‹çš„å¸è½½æ–‡ä»¶åœ¨ä»€ä¹ˆåœ°æ–¹å»è°ƒç”¨å®ƒçš„,è‚¯å®šä¸èƒ½åº”ç”¨äºæ‰€æœ‰åœºæ™¯,åº”è¯¥éå†è¯¥è½¯ä»¶å®‰è£…çš„æ ¹ç›®å½•å’Œå­ç›®å½•æœç´¢å¸è½½ç¨‹åºæ‰€åœ¨çš„æœ€ç»ˆç›®å½•æ¥æ‰§è¡Œå¹¶è¿›è¡Œå¸è½½ã€‚</p>
<h5 id="è®°åœ¨2017-03-30"><a href="#è®°åœ¨2017-03-30" class="headerlink" title="è®°åœ¨2017-03-30"></a>è®°åœ¨2017-03-30</h5><p>ä»Šå¤©å°è¯•ç”¨æ˜¨å¤©çš„å†™æ³•æ¥å®ç°è½¯ä»¶å¸è½½,å‘ç°å®ç°èµ·æ¥å¹¶ä¸æ˜¯é‚£ä¹ˆç®€å•,è€Œä¸”éå†æ–‡ä»¶çš„è¯é¢ä¸´ä¸€ä¸ªæ€§èƒ½é—®é¢˜,å±‚çº§ä¸€å¤š,é€’å½’å¾ªç¯å°±å¯èƒ½å¯¼è‡´éœ€è¦ç­‰å¥½ä¹…æ‰èƒ½å¼€å§‹å¸è½½,æ‰€ä»¥åˆæ·±å…¥ç ”ç©¶äº†ä¸‹æ³¨å†Œè¡¨,çœŸæ˜¯å¾—æ¥å…¨ä¸è´¹å·¥å¤«,æ³¨å†Œè¡¨é‡Œé¢å°±ç»™æˆ‘ä»¬æä¾›äº†æŸä¸ªè½¯ä»¶çš„å¸è½½è·¯å¾„,å…·ä½“ä½ç½®åœ¨</p>
<pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\
</code></pre><p>è¿™è¾¹éƒ½æ˜¯æˆ‘ä»¬å®‰è£…çš„æ‰€æœ‰è½¯ä»¶,éœ€è¦æ³¨æ„çš„æ˜¯åœ¨64ä½ç³»ç»Ÿä¸­è¯¥è·¯å¾„æœ‰æ‰€ä¸åŒ,å¤§é—®é¢˜è§£å†³äº†,æˆ‘ä»¬åˆé¢ä¸´ä¸€ä¸ªå…¶ä»–é—®é¢˜,å°±æ˜¯æœ‰äº›è½¯ä»¶åœ¨å®‰è£…å,å¸è½½é‚£ä¸€çº§çš„æœ€åä¸€å±‚å¹¶ä¸æ˜¯å®ƒè‡ªå·±çš„åå­—,è€Œæ˜¯ä¸€ä¸²èŠ±æ‹¬å·å¼€å§‹èŠ±æ‹¬å·ç»“å°¾çš„å­—ç¬¦ä¸²,ç±»ä¼¼äºä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="/imgs/uninstall-id.png" alt="å¸è½½id"></p>
<p>äºæ˜¯åˆåœ¨å¥½å‡ ç§ä¸åŒç‰ˆæœ¬çš„windowsç”µè„‘ä¸Šè¿›è¡Œå°è¯•,å‘ç°è¿™ä¸ªidå§‹ç»ˆæ˜¯å”¯ä¸€çš„,æœ€åå’Œéœ€æ±‚å•†é‡å†³å®šåå°ç®¡ç†å‘˜åœ¨æä¾›è½¯ä»¶çš„æ—¶å€™æŠŠè¿™ä¸ªidä¹Ÿå¸¦ä¸Š,è¿™æ ·å°±è§£å†³äº†é—®é¢˜,è¿™æ ·å”¯ä¸€çš„ä¸å¥½å°±æ˜¯åå°ç®¡ç†å‘˜çš„å·¥ä½œå¯èƒ½ä¼šç¨å¾®ç¹çç‚¹ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘åœ¨åŸºäºnode-webkit(ä»¥ä¸‹ç®€ç§°NW)å¼€å‘windowsæ¡Œé¢app,é‡Œé¢æœ‰ä¸ªç±»ä¼¼äºè½¯ä»¶å¸‚åœºçš„åŠŸèƒ½,åå°ç®¡ç†å‘˜æä¾›ä¸€äº›è½¯ä»¶,å¯ä»¥ä»è¯¥appä¸Šè¿›è¡Œä¸‹è½½ã€å®‰è£…ã€å¸è½½ã€å‡çº§ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å®‰è£…æˆ–å‡çº§å¯ä»¥ç›´æ¥é€šè¿‡æŠŠä¸‹è½½å¥½çš„zipåŒ…è§£å‹å‡ºæ¥ç„¶åæ‰§è¡Œé‡Œé¢çš„exeç¨‹åºå®‰è£…å°±
    
    </summary>
    
      <category term="nodejs" scheme="http://yoursite.com/categories/nodejs/"/>
    
      <category term="æ¡Œé¢exe" scheme="http://yoursite.com/categories/nodejs/%E6%A1%8C%E9%9D%A2exe/"/>
    
    
  </entry>
  
  <entry>
    <title>decoratorçš„å­¦ä¹ </title>
    <link href="http://yoursite.com/2017/02/17/2017-02-17-es7-decorator-tourial/"/>
    <id>http://yoursite.com/2017/02/17/2017-02-17-es7-decorator-tourial/</id>
    <published>2017-02-16T16:00:00.000Z</published>
    <updated>2017-02-17T12:44:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>éšç€å‰ç«¯æŠ€æœ¯çš„å‘å±•,è¶Šæ¥è¶Šå¤šäººæŠŠES6ã€7ç”¨åœ¨æ—¥å¸¸å¼€å‘ä¸­,åœ¨ES7ä¸­é™¤äº†å¹¿ä¸ºäººçŸ¥çš„async/awaitä¹‹å¤–,è¿˜æœ‰ä¸€å¤§ç‰¹æ€§ â€” decorator(è£…é¥°å™¨)ã€‚</p>
<p>åœ¨ä¹‹å‰åŸç”Ÿjavascriptè®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç¯‡æ–‡ç« (<a href="http://rwson.github.io/2015/07/15/2015-07-15-js-design-mode-decorator/" target="_blank" rel="external">javascriptè£…é¥°è€…æ¨¡å¼</a>)ä¸­è¯´é“: jsè£…é¥°è€…æ¨¡å¼å¯ä»¥æŠŠä¸€ä¸ªå¯¹è±¡(ç±»/å‡½æ•°)é€æ˜åœ°åŒ…è£…åœ¨å¦å¤–ä¸€ä¸ªå¯¹è±¡ä¸Š,å®Œæˆå¯¹è¢«è£…é¥°è€…æ·»åŠ ä¸€äº›æ–°åŠŸèƒ½çš„ä½œç”¨ã€‚ç®€å•çš„è¯´æˆ‘ä»¬å¯ä»¥åœ¨ä¸ä¿®æ”¹ç±»/å‡½æ•°å†…éƒ¨ä»£ç çš„æƒ…å†µä¸‹,æ¥è¾¾åˆ°ç»™ç±»/å‡½æ•°åŠ å…¥ä¸€äº›æ–°åŠŸèƒ½ã€‚</p>
<p>è£…é¥°å™¨å¯ä»¥ä½œç”¨äºç±»æˆ–è€…ç±»çš„æˆå‘˜å±æ€§/æ–¹æ³•ä¸Š,ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸¤æ®µä»£ç æ¥åˆ†åˆ«è§£é‡Š:</p>
<pre><code>//  ä½œç”¨äºç±»

/**
 * éœ€æ±‚:
 * å°è£…4ä¸ªæ–¹æ³•,åˆ†åˆ«å®ç°åŠ å‡ä¹˜é™¤å››ä¸ªåŠŸèƒ½
 * é€šè¿‡è£…é¥°å™¨ç»™ç±»æ·»åŠ è¿™å››ä¸ªæ–¹æ³•,å¹¶ä¸”å¯æŒ‡å®šæ˜¯å¦ä½œä¸ºç±»çš„é™æ€æ–¹æ³•æ·»åŠ 
 **/

//  åŠ å‡ä¹˜é™¤çš„å®ç°

function add() {
    return [].slice.call(arguments).reduce((a, b) =&gt; a + b);
}

function reduce() {
    return [].slice.call(arguments).reduce((a, b) =&gt; a - b);
}

function mul() {
    return [].slice.call(arguments).reduce((a, b) =&gt; a * b);
}

function div() {
    return [].slice.call(arguments).reduce((a, b) =&gt; a / b);
}


@bindCal(add, true)
@bindCal(reduce, true)
@bindCal(mul, false)
@bindCal(div, false)
class MyMath {

}
</code></pre><p>ä¸Šé¢æˆ‘ä»¬å®Œæˆäº†éœ€æ±‚ä¸­çš„å››ä¸ªå‡½æ•°çš„å°è£…ä»¥åŠå¯¹MyMathç±»åº”ç”¨äº†è£…é¥°å™¨,ä¸‹é¢æˆ‘ä»¬å°±æ¥å®ç°è¿™ä¸ªè£…é¥°å™¨:</p>
<pre><code>/**
 * @param    {Function}   method    æŒ‡å‘éœ€è¦è¢«æ·»åŠ æ–¹æ³•çš„æŒ‡é’ˆ
 * @param    {String}     isStatic  æ˜¯å¦æ·»åŠ ä¸ºé™æ€å±æ€§,é»˜è®¤ä¸ºtrue
 * @return   {Function}
 */
function bindCal(method, isStatic = true) {
    //  è·å–åˆ°æ–¹æ³•å
    const {name} = method;
    //  å½“ä½œç”¨äºç±»ä¸Šæ—¶,ä¼šè¿”å›ä¸€ä¸ªåŒ¿åå‡½æ•°,å°†ç±»çš„æ„é€ å‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°
    return function(target) {
        //  è·å–ç±»çš„åŸå‹
        const {prototype} = target;
        //  æ·»åŠ ä¸ºåŸå‹å±æ€§(éé™æ€å±æ€§)
        if (!isStatic) {
            //  æ£€æµ‹è¦æ·»åŠ çš„å±æ€§æ˜¯å¦å­˜åœ¨
            if (prototype[name]) {
                throw `${prototype.name}.${name} already exits!`;
            } else {
                //  åˆ©ç”¨ES5ä¸­çš„Object.definePropertyæ¥æ·»åŠ ç›¸å…³å±æ€§
                Object.defineProperty(target.prototype, name, {
                    value: method
                });
            }
        } else {
            //  æ·»åŠ ä¸ºé™æ€å±æ€§
            //  æ£€æµ‹è¦æ·»åŠ çš„å±æ€§æ˜¯å¦å­˜åœ¨
            if (target[name]) {
                throw `${target}.${name} already exits!`;
            }
            //  åˆ©ç”¨ES5ä¸­çš„Object.definePropertyæ¥æ·»åŠ ç›¸å…³å±æ€§
            Object.defineProperty(target, name, {
                value: method
            });
        }
        //  è¿”å›ç±»çš„æ„é€ å™¨
        return target;
    }
}
</code></pre><p>æˆ‘ä»¬æŠŠaddå’Œreduceä½œä¸ºé™æ€æ–¹æ³•æ·»åŠ ç»™MyMathç±»,æŠŠmulå’Œdivä½œä¸ºåŸå‹æ–¹æ³•ç»™äº†MyMathç±»,æ‰€ä»¥è°ƒç”¨åº”è¯¥çœ‹èµ·æ¥åƒä¸‹é¢çš„æ ·å­:</p>
<pre><code>const math = new MyMath();

console.log(MyMath.add(1, 2, 3, 4));        //  10
console.log(MyMath.reduce(1, 2, 3, 4));     //  -8


console.log(math.mul(1, 2, 3, 4));          //  24
console.log(math.div(10000, 1000, 10, 5));  //  0.2
</code></pre><p>ä¸Šé¢å°±æ˜¯æˆ‘ä»¬åœ¨ç±»ä¸Šåº”ç”¨è£…é¥°å™¨çš„ä¸€ä¸ªä¾‹å­,ä¸‹é¢å†ä¸€èµ·çœ‹ä¸‹å¦‚æœåœ¨æˆå‘˜å±æ€§/æ–¹æ³•ä¸Šåº”ç”¨æ„é€ å™¨çš„ä¾‹å­:</p>
<pre><code>/**
 * éœ€æ±‚:
 * å®ç°åœ¨ç±»ä¸­å¯ä»¥å†»ç»“æˆå‘˜å±æ€§(å¤–éƒ¨æ— æ³•ä¿®æ”¹,åªè¯»)
 * å®ç°ä¿®æ”¹ç±»ä¸­æˆå‘˜æ–¹æ³•ä¸­çš„thisæŒ‡å‘
 **/


//  å®ç°ä¸€ä¸ªç±»,å¹¶ä¸”å¯¹å…¶æˆå‘˜å±æ€§/æ–¹æ³•åº”ç”¨è£…é¥°å™¨ã€å®šä¹‰ä¸€ä¸ªå¯¹è±¡,ä½œä¸ºæˆå‘˜æ–¹æ³•ä¸­çš„thisæŒ‡å‘


const obj = {
    name: &quot;rwson&quot;,
    age: 24,
    sex: &quot;male&quot;,
    job: &quot;web developer&quot;
};

class Context {

    constructor() {

    }

    @readonly
    version = &quot;1.0.0&quot;;

    @bindContext(obj)
    showContext() {
        console.log(this);
    }

} 
</code></pre><p>ä¸Šé¢æˆ‘ä»¬å®Œæˆäº†å¯¹è£…é¥°å™¨åº”ç”¨è¿‡ç¨‹,ä¸‹é¢ä¸€èµ·çœ‹ä¸‹readonlyå’ŒbindContextä¸¤ä¸ªè£…é¥°å™¨çš„å®ç°:</p>
<pre><code>/**
 * @param    {Object}   target    å½“å‰ç±»çš„prototype
 * @param    {String}   key       å°†è¦è¢«è£…é¥°çš„å±æ€§å
 * @param    {Object}   decorator ES5ä¸­Object.definePropertyçš„æœ€åä¸€ä¸ªå‚æ•°
 * @return   {Object}   decorator
 */
function readonly(target, key, decorator) {
    decorator.configurable = false;
    decorator.enumerable = false;
    decorator.writable = false;
    decorator.value = decorator.value;
    return decorator;
}

/**
 * @param    {Object}   context    éœ€è¦ç»‘å®šæˆthisçš„å¯¹è±¡
 * @return   {Function}
 */
function bindContext(context) {
    /**
     * @param    {Object}   target    å½“å‰ç±»çš„prototype
     * @param    {String}   key       å°†è¦è¢«è£…é¥°çš„å±æ€§å
     * @param    {Object}   decorator ES5ä¸­Object.definePropertyçš„æœ€åä¸€ä¸ªå‚æ•°
     * @return   {Object}   decorator
     */
    return function(target, key, decorator) {
        if (typeof context === &quot;undefined&quot;) {
            context = target;
        }
        decorator.value = decorator.value.bind(context);
        return decorator;
    }
}
</code></pre><p>å¥½äº†ä¸Šé¢å°±æ˜¯æˆ‘ä»¬çš„ä¸¤ä¸ªä½œç”¨äºæˆå‘˜å±æ€§/æ–¹æ³•ä¸Šçš„è£…é¥°å™¨,ä¸‹é¢ä¸€èµ·æ¥çœ‹ä¸‹ç®€å•çš„è°ƒç”¨å§:</p>
<pre><code>const context = new Context();

context.showContext();          //  æ‰“å°å‡ºåˆšæ‰å®šä¹‰çš„objå¯¹è±¡
context.version = &quot;1.1.0&quot;;      //  æŠ›å‡ºå¼‚å¸¸ Uncaught TypeError: Cannot assign to read only property &apos;version&apos; of object &apos;#&lt;Context&gt;&apos;
</code></pre><p>å¥½äº†,ä¸Šé¢å°±è£…é¥°å™¨çš„å‡ ç§ç”¨æ³•å’Œå®ç°,æˆ‘ä»¬å¯èƒ½ä¼šå‘ç°åˆšæ‰åœ¨å®šä¹‰è£…é¥°å™¨å‡½æ•°çš„æ—¶å€™,å½“è¯¥è£…é¥°å™¨ä½œç”¨äºç±»ä¸Šçš„æ—¶å€™è¿”å›å‡ºçš„åŒ¿åå‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå‚æ•°;è€Œä½œç”¨äºæˆå‘˜å±æ€§æˆ–è€…æˆå‘˜æ–¹æ³•ä¸Šçš„,éƒ½æ˜¯ä¸‰ä¸ªå‚æ•°,è¿™åˆæ˜¯ä¸ºå•¥å‘¢?</p>
<p>ä¸€èµ·æ¥åˆ†æä¸‹ç¼–è¯‘åçš„ä»£ç :</p>
<pre><code>/**
 * @param    {Object}               target     å½“å‰ç±»çš„prototype
 * @param    {String}               property   å°†è¦è¢«è£…é¥°çš„å±æ€§å
 * @param    {Array.&lt;Function&gt;}       decorators è£…é¥°å™¨å‡½æ•°åˆ—è¡¨
 * @param    {Object}               descriptor ES5ä¸­Object.definePropertyçš„æœ€åä¸€ä¸ªå‚æ•°
 * @param    {[type]}   context    [description]
 * @return   {[type]}              [description]
 * @private
 */
function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {

    //    å±æ€§å¯¹è±¡
    var desc = {};

    //    Object[&quot;keys&quot;]    -&gt; [&quot;value&quot;, &quot;writable&quot;, &quot;enumerable&quot;, &quot;configurable&quot;]
    //    æŠŠES5ä¸­Object.definePropertyçš„æœ€åä¸€ä¸ªå‚æ•°çš„å±æ€§å˜æˆå¤–éƒ¨æŒ‡å®šçš„
    Object[&apos;ke&apos; + &apos;ys&apos;](descriptor).forEach(function (key) {
        desc[key] = descriptor[key];
    });
    desc.enumerable = !!desc.enumerable;
    desc.configurable = !!desc.configurable;

    if (&apos;value&apos; in desc || desc.initializer) {
        desc.writable = true;
    }

    desc = decorators.slice().reverse().reduce(function (desc, decorator) {
        return decorator(target, property, desc) || desc;
    }, desc);

    if (context &amp;&amp; desc.initializer !== void 0) {
        desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
        desc.initializer = undefined;
    }

    //    åˆ©ç”¨Object.definePropertyå®šä¹‰å±æ€§
    if (desc.initializer === void 0) {
        Object[&apos;define&apos; + &apos;Property&apos;](target, property, desc);
        desc = null;
    }

    //    è¿”å›å½“å‰å±æ€§å¯¹è±¡
    return desc;
}
</code></pre><p>å¯ä»¥çœ‹å‡ºå…¶å®decoratoræœ€åä¹Ÿæ˜¯é€šè¿‡Object.definePropertyå®ç°çš„,æ‰€ä»¥å‚æ•°å’ŒObject.definePropertyæ˜¯ä¸€è‡´çš„ã€‚</p>
<p>é‚£æ—¥å¸¸å¼€å‘ä¸­,æˆ‘ä»¬å¯èƒ½éœ€è¦å€ŸåŠ©babelæ¥å¯¹å¸¦æœ‰decoratorçš„ä»£ç è¿›è¡Œç¼–è¯‘,é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…babel:</p>
<pre><code>npm install babel -g
</code></pre><p>ç„¶ååˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•è¿è¡Œ:</p>
<pre><code>npm install babel-plugin-transform-decorators-legacy --save-dev
</code></pre><p>ç„¶ååˆ›å»º.babelrcé…ç½®æ–‡ä»¶,åœ¨pluginsé€‰é¡¹ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®:</p>
<pre><code>//  ...
&quot;plugins&quot;: [
    &quot;transform-decorators-legacy&quot;
]
//  ...
</code></pre><p>æœ€åæˆ‘ä»¬å°±å¯ä»¥ç¼–è¯‘ä¹‹å‰å†™çš„ä»£ç äº†:</p>
<pre><code>babel decorator.js &gt; decorator.es5.js
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;éšç€å‰ç«¯æŠ€æœ¯çš„å‘å±•,è¶Šæ¥è¶Šå¤šäººæŠŠES6ã€7ç”¨åœ¨æ—¥å¸¸å¼€å‘ä¸­,åœ¨ES7ä¸­é™¤äº†å¹¿ä¸ºäººçŸ¥çš„async/awaitä¹‹å¤–,è¿˜æœ‰ä¸€å¤§ç‰¹æ€§ â€” decorator(è£…é¥°å™¨)ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¹‹å‰åŸç”Ÿjavascriptè®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç¯‡æ–‡ç« (&lt;a href=&quot;http://rwson.gi
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="ES7" scheme="http://yoursite.com/categories/javascript/ES7/"/>
    
      <category term="decorator" scheme="http://yoursite.com/categories/javascript/ES7/decorator/"/>
    
    
  </entry>
  
  <entry>
    <title>å®ç°ä¸€ä¸ªæ‹·è´æ–‡ä»¶å¤¹ä»¥åŠæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶çš„æ–¹æ³•</title>
    <link href="http://yoursite.com/2017/01/20/2017-01-20-copy-a-directory-and-files-under-it/"/>
    <id>http://yoursite.com/2017/01/20/2017-01-20-copy-a-directory-and-files-under-it/</id>
    <published>2017-01-19T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>å®ç°è¿™ä¸ªæ–¹æ³•ä¾èµ–äº†<a href="https://www.npmjs.com/package/fs-extra" target="_blank" rel="external">fs-extra</a>æ¨¡å—,å®ç°ç›®çš„æ˜¯ä¸ºäº†ä¸€ä¸ªæ–¹æ³•æ‹·è´æ‰€æœ‰å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶,å…·ä½“å®ç°å¦‚ä¸‹:</p>
<pre><code>let fs = require(&quot;fs-extra&quot;);

/**
 * æ‰¹é‡æ‹·è´æ–‡ä»¶
 * @param src           æºç›®å½•          String
 * @param target        ç›®æ ‡ç›®å½•        String
 * @param filetypes     æ–‡ä»¶ç±»å‹        RegExp
 * @param ignorefiles   å¿½ç•¥æ–‡ä»¶åˆ—è¡¨    Array
 **/
fs.copyAllFiles = (src, target, filetypes, ignorefiles) =&gt; {
    let argus = arguments,
        readSrc = src,
        targetSrc = target,
        fileSrc, targeFileSrc;

    fs.readdir(readSrc, (ex, files) =&gt; {
        if (files.length) {
            files.forEach((file) =&gt; {

                //  å½“å‰æ–‡ä»¶ä¸åœ¨å¿½ç•¥åˆ—è¡¨ä¸­
                if (!(~ignoreFiles.indexOf(file))) {
                    fileSrc = path.resolve(readSrc, file);
                    if (filetypes.test(file)) {
                        targeFileSrc = path.resolve(targetSrc, file);
                        fs.copySync(fileSrc, targeFileSrc);
                    } else {
                        targeFileSrc = path.resolve(targetSrc, file);
                        fs.copySync(fileSrc, targeFileSrc);
                        //  é€’å½’æ‹·è´ä¸‹ä¸€çº§ç›®å½•
                        fs.copyAllFiles.call(fileSrc, targeFileSrc, filetypes, ignorefiles);
                    }
                }
            });
        }
    });
};
</code></pre><p>ä¸Šé¢çš„å°±æ˜¯è¦å®ç°çš„æ–¹æ³•,è°ƒç”¨çš„æ–¹æ³•å°±çœ‹èµ·æ¥åƒä¸‹é¢çš„æ ·å­:</p>
<pre><code>const ignoreFiles = [&quot;.DS_Store&quot;, &quot;.idea&quot;, &quot;.git&quot;, &quot;.svn&quot;];
fs.copyAllFiles(&quot;a&quot;, &quot;b&quot;, /\.jpe?g|\.png/, ignoreFiles);
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å®ç°è¿™ä¸ªæ–¹æ³•ä¾èµ–äº†&lt;a href=&quot;https://www.npmjs.com/package/fs-extra&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;fs-extra&lt;/a&gt;æ¨¡å—,å®ç°ç›®çš„æ˜¯ä¸ºäº†ä¸€ä¸ªæ–¹æ³•æ‹·è´æ‰€æœ‰å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶,å…·ä½“å®ç°å¦‚ä¸‹:&lt;
    
    </summary>
    
      <category term="nodejs" scheme="http://yoursite.com/categories/nodejs/"/>
    
      <category term="æ–‡ä»¶æ“ä½œ" scheme="http://yoursite.com/categories/nodejs/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>å®ç°ä¸€ä¸ªwebpack loader</title>
    <link href="http://yoursite.com/2017/01/18/2017-01-18-wrire-a-webpack-loader/"/>
    <id>http://yoursite.com/2017/01/18/2017-01-18-wrire-a-webpack-loader/</id>
    <published>2017-01-17T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨React,ES6å¼€å‘æ¨¡å¼è¶Šæ¥è¶Šæ™®åŠçš„ä»Šå¤©,webpackå°±æˆäº†å‰ç«¯æ„å»ºçš„ä¸€ä¸ªæ ‡é…ã€‚webpackæœ‰ä¸¤å¤§é‡è¦éƒ¨åˆ†ç»„æˆ: loaderå’Œpluginã€‚loaderæ˜¯ç”¨åœ¨åº”ç”¨æºç ä¸Šçš„è½¬æ¢åŸä»¶,æ¯”å¦‚æœ€å¸¸ç”¨åˆ°çš„babel-loader/jsx-loader/file-loader/css-loader/url-loaderç­‰ç­‰ã€‚</p>
<p>loaderå¯é“¾å¼æ‰§è¡Œ,ä¸€ç§æ–‡ä»¶ç±»å‹å¯ä»¥ç”¨å¤šä¸ªloader(æ¯”å¦‚cssæ–‡ä»¶,å¯èƒ½å°±éœ€è¦ç”¨åˆ°css-loaderå’Œstyle-loader),loaderä¹‹é—´ç”¨â€!â€åˆ†éš”,å½“å‰loaderå¤„ç†å®Œ,æŠŠå¤„ç†ç»“æœå¸¦åˆ°ä¸‹ä¸€ä¸ªloader,æœ€åä¸€ä¸ªloaderè¿”å›ä¸€ä¸ªStringæˆ–è€…String Bufferè¿”å›ç»™compilerã€‚</p>
<p>loaderè°ƒç”¨æ–¹å¼å¤§ä½“æœ‰3ç§å½¢å¼:</p>
<ol>
<li><p>å¼•ç”¨æ—¶è°ƒç”¨</p>
<pre><code>//  a.js

require(&quot;style-loader/url!css-loader!./xxx.css&quot;);
</code></pre></li>
<li><p>webpackç›´æ¥è°ƒç”¨</p>
<pre><code>//  webpack.config.js

//  ...

module: {
    loaders: [
        //  ...

        {
            test: /\.css$/,
            loader: &quot;style-loader!css-loader&quot;
        }
    ]
}
</code></pre></li>
<li><p>æŒ‡å®šloadersæ•°ç»„</p>
<pre><code>//  webpack.config.js

//  ...

module: {
    loaders: [
        //  ...

        {
            test: /\.css$/,
            loaders: [
                &quot;style-loader&quot;,
                &quot;css-loader&quot;
            ]
        }
    ]
}
</code></pre></li>
</ol>
<p>webpackå®˜ç½‘ä¸Šè¯´â€A loader is a node module exporting a functionâ€,ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªloaderå°±æ˜¯ä¸€ä¸ªæš´éœ²å‡ºå»çš„nodeæ¨¡å—,æ—¢ç„¶æ˜¯ä¸€ä¸ªnode module,ä¹Ÿå°±åŸºæœ¬å¯ä»¥å†™æˆä¸‹é¢çš„æ ·å­:</p>
<pre><code>module.exports = function() {

    //  ...
};
</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯,åœ¨è¯¥æ¨¡å—è¢«è°ƒç”¨æ—¶,ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶çš„å†…å®¹,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†æ”¹æ”¹:</p>
<pre><code>/**
 * @param content  å°†è¢«å¤„ç†çš„å†…å®¹
 *
 **/
module.exports = function(content) {

    //  ...

    //  è¿è¡Œä¸‹ä¸€ä¸ªloader
    this.callback(content);
};
</code></pre><p>çŸ¥é“äº†å¤§ä½“å†™æ³•,ç°åœ¨æˆ‘ä»¬å°±æ¥å®ç°ä¸€ä¸ªç®€å•çš„loader,ä¸»è¦åŠŸèƒ½å°±æ˜¯æŠŠcssä¸­çš„pxå•ä½è½¬æ¢æˆremå•ä½</p>
<pre><code>//  px2rem-loader/index.js

&quot;use strict&quot;;

//  ç”¨æ¥è·å–è°ƒç”¨loaderæ—¶ä¼ å…¥çš„å‚æ•°ç­‰ç­‰
var loaderUtils = require(&quot;loader-utils&quot;);

//  cssè§£ææ¨¡å—
var css = require(&quot;css&quot;);

//  ä¹˜é™¤æ¨¡å—,é˜²æ­¢åœ¨è®¡ç®—ä¸­å‡ºç°ç²¾åº¦ä¸¢å¤±çš„é—®é¢˜
var privateMath = {

    mul: function(num1, num2) {
        var m = 0,
            s1 = num1.toString(),
            s2 = num2.toString();
        try {
            m += s1.split(&quot;.&quot;)[1].length
        } catch (e) {}
        try {
            m += s2.split(&quot;.&quot;)[1].length
        } catch (e) {}
        return Number(s1.replace(&quot;.&quot;, &quot;&quot;)) * Number(s2.replace(&quot;.&quot;, &quot;&quot;)) / Math.pow(10, m);
    },
    div: function(num1, num2) {
        var t1, t2, r1, r2;
        try {
            t1 = num1.toString().split(&apos;.&apos;)[1].length;
        } catch (e) {
            t1 = 0;
        }
        try {
            t2 = num2.toString().split(&quot;.&quot;)[1].length;
        } catch (e) {
            t2 = 0;
        }
        r1 = Number(num1.toString().replace(&quot;.&quot;, &quot;&quot;));
        r2 = Number(num2.toString().replace(&quot;.&quot;, &quot;&quot;));
        return (r1 / r2) * Math.pow(10, t2 - t1);
    }
};

module.exports = function(content) {

    //  æŠŠå½“æˆcsså†…å®¹è§£ææˆASTå¯¹è±¡
    var contentAST = css.parse(content);

    //  ä½¿ç”¨loaderæ—¶çš„queryString(ç›¸å…³å‚æ•°)
    var query = loaderUtils.parseQuery(this.query);

    //  æœ€å°pxå€¼,å½“æ•°ç»„å°äºå®ƒæ˜¯å¿½ç•¥è®¡ç®—
    var minSize = query.minSize || 1;

    //  åŸºæ•°(æœ€åè®¡ç®—å‡ºçš„ç»“æœ = (åŸå…ˆçš„å¤§å° / base / scale) + &quot;rem&quot;)
    var base = query.base || 37.5;

    //  å¿½ç•¥çš„æ ·å¼è§„åˆ™åç§°
    var ignore = query.ignore.length ? query.ignore.split(&quot;|&quot;) : [];

    //  ç¼©æ”¾æ¯”
    var scale = query.scale || 1;

    //  åŒ¹é…10pxæˆ–è€…10.5pxè¿™ç§å•ä½
    var pxUnitReg = /\d+[\.{1}\d+]?px/gi;

    var tmp;

    //  éå†æ ·å¼æ ‘
    contentAST.stylesheet.rules.forEach(function(rule) {
        //  éå†æ ·å¼è¡¨
        rule.declarations.forEach(function(style) {
            if (ignore.indexOf(style.property) &lt; 0) {
                style.value = style.value.replace(pxUnitReg, function(match) {
                    tmp = parseFloat(match);
                    if(tmp &gt; minSize) {
                        return privateMath.div(tmp, privateMath.mul(base, scale)) + &quot;rem&quot;;
                    }
                });
            }
        });
    });


    //  å†æŠŠå¤„ç†å¥½çš„ASTå¯¹è±¡è½¬æˆcss String
    content = css.stringify(contentAST);

    //  è°ƒç”¨ä¸‹ä¸€ä¸ªloader
    this.callback(null, content);

};
</code></pre><p>åˆ°è¿™é‡Œ,ä¸€ä¸ªç®€å•çš„loadå°±ç®—å®ç°äº†,ä¸€èµ·æ¥çœ‹ä¸‹è°ƒç”¨æŠŠ:</p>
<pre><code>//  webpack.config.js
const webpack = require(&quot;webpack&quot;);

module.exports = {
    entry: &quot;./src/js/entry.js&quot;,
    output: {
        path: __dirname,
        filename: &quot;build/bundle.js&quot;
    },
    module: {
        loaders: [{
            test: /\.js$/,
            loader: &apos;babel-loader?presets[]=es2015&apos;
        }, {
            test: /\.css$/,
            loader: &apos;style-loader!css-loader!px2rem-loader?base=37.5&amp;scale=2&amp;minSize=1&amp;ignore=border|margin|padding&apos;
        }]
    },
    plugins: [
    ]
};
</code></pre><p>ä¹‹å‰çš„css:</p>
<p><img src="/imgs/webpack-loader-1.png" alt=""></p>
<p>æ‰“åŒ…ä¹‹å:</p>
<p><img src="/imgs/webpack-px-2rem-compiled.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨React,ES6å¼€å‘æ¨¡å¼è¶Šæ¥è¶Šæ™®åŠçš„ä»Šå¤©,webpackå°±æˆäº†å‰ç«¯æ„å»ºçš„ä¸€ä¸ªæ ‡é…ã€‚webpackæœ‰ä¸¤å¤§é‡è¦éƒ¨åˆ†ç»„æˆ: loaderå’Œpluginã€‚loaderæ˜¯ç”¨åœ¨åº”ç”¨æºç ä¸Šçš„è½¬æ¢åŸä»¶,æ¯”å¦‚æœ€å¸¸ç”¨åˆ°çš„babel-loader/jsx-loader/file-loader
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="æ„å»ºå·¥å…·" scheme="http://yoursite.com/categories/javascript/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/"/>
    
      <category term="webpack" scheme="http://yoursite.com/categories/javascript/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/webpack/"/>
    
    
  </entry>
  
  <entry>
    <title>Shadow DOMç ”ç©¶</title>
    <link href="http://yoursite.com/2016/12/12/2016-12-12-chrome-shadow-dom-tourial/"/>
    <id>http://yoursite.com/2016/12/12/2016-12-12-chrome-shadow-dom-tourial/</id>
    <published>2016-12-11T16:00:00.000Z</published>
    <updated>2017-02-11T03:55:27.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨<a href="https://github.com/Polymer/polymer" target="_blank" rel="external">Polymer</a>ä¸­,æå‡ºäº†<a href="https://developer.mozilla.org/zh-CN/docs/Web/Web_Components" target="_blank" rel="external">Web Component</a>çš„æ¦‚å¿µ,æ—¨åœ¨è®©å¼€å‘è€…å¯ä»¥å°è£…å‡ºå¾ˆå¤šå¯å¤ç”¨çš„ç»„ä»¶ã€‚ç°åœ¨,webkitæ·»åŠ äº†å¯¹è¯¥APIæ”¯æŒ,ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬ä¸ç”¨å€ŸåŠ©æ¡†æ¶,ä¹Ÿå¯ä»¥è‡ªå·±å°è£…å‡ºå¯å¤ç”¨çš„ç»„ä»¶(é€šè¿‡è‡ªå®šä¹‰å…ƒç´ çš„å½¢å¼),è€Œä¸éœ€è¦ä¾èµ–å…¶ä»–æ¡†æ¶æ¥å®ç°ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬è¿™è¾¹éœ€è¦å°è£…ä¸€ä¸ªè¿›åº¦æ¡ç»„ä»¶,å®ç°ä»£ç å¤§æ¦‚æ˜¯è¿™æ ·çš„:</p>
<pre><code>//  javascript

class CustomProgressBar extends HTMLElement {

    constructor(args) {
        super(args);

        //  createShadowRootç”¨æ¥åˆ›å»ºä¸€ä¸ªshadowDOMå®ä¾‹
        const shadowRoot = this.createShadowRoot();

        //  è®¾ç½®ç»„ä»¶å†…çš„å¸ƒå±€ç»“æ„å’Œæ ·å¼
        shadowRoot.innerHTML = `
            &lt;style type=&quot;text/css&quot;&gt;
                :host {
                    display: inline-block;
                    width: 200px;
                    height: 30px;
                    box-sizing: border-box;
                    padding: 1px;
                }
                :host * {
                    -webkit-touch-callout: none;
                    -webkit-user-select: none;
                    -khtml-user-select: none;
                    -moz-user-select: none;
                    -ms-user-select: none;
                    user-select: none;
                }
                .progress {
                    display: inline-block;
                    width: 200px;
                    height: 30px;
                    position: relative;
                    border: 1px solid #000;
                }
                .progress &gt; .bar {
                    background: red;
                    height: 100%;
                    width: 0;
                    transition: all 0.2s;
                }

                .progress .label {
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    text-align: center;
                    font-size: 14px;
                    line-height: 30px;
                    color: #000;
                }
            &lt;/style&gt;
            &lt;div class=&quot;progress&quot; aria-valuenow=&quot;0&quot; aria-valuemin=&quot;0&quot; aria-valuemax=&quot;100&quot;&gt;
                &lt;div class=&quot;bar&quot;&gt;&lt;/div&gt;
                &lt;div class=&quot;label&quot;&gt;0%&lt;/div&gt;
            &lt;/div&gt;
        `;

        //  å°†ç›¸å…³å…ƒç´ å­˜å‚¨åˆ°æˆå‘˜å˜é‡ä¸­
        this._progressElement = shadowRoot.querySelector(&quot;.progress&quot;);
        this._bar = shadowRoot.querySelector(&quot;.bar&quot;);
        this._label = shadowRoot.querySelector(&quot;.label&quot;);
    }

    /**
     * å–å¾—å½“å‰è¿›åº¦
     * @return {string}
     */
    get progress() {
        return Number(this._progressElement.getAttribute(&quot;aria-valuenow&quot;));
    }

    /**
     * è®¾ç½®è¿›åº¦
     * @param value
     */
    set progress(value) {
        //  æœ€å¤§å€¼å€¼æœ€å°å€¼
        const max = this._progressElement.getAttribute(&quot;aria-valuemax&quot;),
              min = this._progressElement.getAttribute(&quot;aria-valuemin&quot;);

        //  ç±»å‹åˆ¤æ–­
        if(Number.isNaN(Number(value))) {
            throw new Error(`value must be an number type, you specified ${value} which is ${{}.toString.call(value).slice(8, -1).toLowerCase()}!`);
        }

        //  èŒƒå›´æ£€æµ‹
        if(value &gt; max || value &lt; min) {
            throw new Error(`value must between ${min} to ${max} , you specified ${value}!`);
        }

        //  è®¾ç½®ç›¸å…³å±æ€§
        this._progressElement.setAttribute(&quot;aria-valuenow&quot;, value);
        this._bar.style.width = `${value}%`;
        this._label.textContent = `${value}%`;
    }

    /**
     * æä¾›å¯ä»¥ç»‘å®šonclickçš„æ¥å£
     * @param callback
     */
    set onclick(callback) {
        if(typeof callback === &quot;function&quot;) {
            this._progressElement.addEventListener(&quot;click&quot;, e =&gt; {
                callback.call(this, e);
            }, false);
        }
    }

}

//  è°ƒç”¨ customElements.defineå®šä¹‰è‡ªå®šä¹‰å…ƒç´ ,ç¬¬ä¸€ä¸ªå‚æ•°è‡ªå®šä¹‰å…ƒç´ å,ç¬¬äºŒä¸ªå‚æ•°æ˜¯HTMLElementçš„ä¸€ä¸ªå­ç±»
customElements.define(&quot;custom-progress-bar&quot;, CustomProgressBar);

window.onload = () =&gt; {

    let customProgressBar = document.querySelector(&quot;custom-progress-bar&quot;),
        progress;

    /**
     * ç»™è¿›åº¦æ¡ç»„ä»¶ç»‘å®šonclickäº‹ä»¶,æ¯æ¬¡ç‚¹å‡»è¿›åº¦åŠ 10
     * @param e
     */
    customProgressBar.onclick = (e) =&gt; {
        progress = Number(this.progress);
        if(progress &gt;= 100) {
            progress = 0;
        } else {
            progress += 10;
        }
        this.progress = progress;
    };

};

//  HTML
//  ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡new CustomProgressBar()æˆ–è€…custom-progress-baræ¥ä½¿ç”¨è‡ªå®šä¹‰å…ƒç´ äº†

&lt;custom-progress-bar&gt;&lt;/custom-progress-bar&gt;
</code></pre><p>è‡³æ­¤æˆ‘ä»¬çš„ä¸€ä¸ªè¿›åº¦æ¡ç»„ä»¶å°±ç®—å°è£…å®Œæˆäº†,éœ€è¦æ³¨æ„çš„æ˜¯,customElements.defineæ–¹æ³•å¯¹ç¬¬ä¸€ä¸ªå‚æ•°æœ‰ä¸€äº›è¦æ±‚:</p>
<ul>
<li>å¿…é¡»ä»¥å°å†™å­—æ¯ a-z å¼€å¤´</li>
<li>ä¸èƒ½åŒ…å«å¤§å†™å­—æ¯ A-Z</li>
<li>å¿…é¡»åŒ…å«â€-â€œ</li>
</ul>
<p>æœ€åæ¸²æŸ“å‡ºæ¥æ˜¯å¦‚ä¸‹çš„å¸ƒå±€ç»“æ„:</p>
<p><img src="/imgs/shadow-dom-rendered.png" alt=""></p>
<p>ä¸€èµ·çœ‹çœ‹å®é™…çš„æ•ˆæœ:</p>
<p><img src="/imgs/shadow-dom-gif.gif" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨&lt;a href=&quot;https://github.com/Polymer/polymer&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Polymer&lt;/a&gt;ä¸­,æå‡ºäº†&lt;a href=&quot;https://developer.mozilla.org/zh-CN
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="Shadow DOM" scheme="http://yoursite.com/categories/javascript/Shadow-DOM/"/>
    
      <category term="Web Component" scheme="http://yoursite.com/categories/javascript/Shadow-DOM/Web-Component/"/>
    
    
  </entry>
  
  <entry>
    <title>Gulpæ’ä»¶çš„ç ”ç©¶</title>
    <link href="http://yoursite.com/2016/11/29/2016-11-29-gulp-plugin-tourial/"/>
    <id>http://yoursite.com/2016/11/29/2016-11-29-gulp-plugin-tourial/</id>
    <published>2016-11-28T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ç½‘é¡µç«¯åŠŸèƒ½è¶Šæ¥è¶Šç¹æ‚çš„ä»Šå¤©,éšç€åŠŸèƒ½çš„å¢å¤š,ä»£ç é‡ä¹Ÿå¿…ä¸å¯å°‘çš„å¤šä¸ª,ä»£ç é‡ä¸€å¤š,webæ€§èƒ½å°±æ˜¾å¾—å°¤ä¸ºé‡è¦,å°¤å…¶æ˜¯åŠ è½½æ–¹é¢,æ—¶é—´å¤ªé•¿,å¯èƒ½ç”¨æˆ·å°±æ²¡å¿ƒæƒ…ç­‰ä¸‹å»,æ‰€ä»¥ç°åœ¨çš„webé¡¹ç›®ä¸€èˆ¬éƒ½åœ¨å‘å¸ƒçš„æ—¶å€™è¿›è¡Œä¸€ç‰ˆè‡ªåŠ¨æ„å»º,ä»åŸæ¥çš„gruntåˆ°gulp,å†åˆ°ç°åœ¨çš„webpackã€‚</p>
<p>ä»Šå¤©ç ”ç©¶äº†ä¸‹gulpæ’ä»¶,å†™ç‚¹å¿ƒå¾—ä½“ä¼šå§ã€‚çœ‹äº†ä¸¤ä¸ªgulpæ’ä»¶æºç ,å‘ç°é‡Œé¢éƒ½å¼•å…¥äº†<a href="https://github.com/rvagg/through2" target="_blank" rel="external">through2</a>è¿™ä¸ªåŒ…,å®˜æ–¹çš„è¯´æ³•å°±æ˜¯â€Node Streamçš„ç®€å•å°è£…ï¼Œç›®çš„æ˜¯è®©é“¾å¼æµæ“ä½œæ›´åŠ ç®€å•;â€,å°±ä¹Ÿç…§è‘«èŠ¦ç”»ç“¢,å¼•ç”¨äº†è¿™ä¸ªåŒ…,ç®€å•å®ç°ä¸€ä¸ªgulpæ’ä»¶,åŠŸèƒ½å°±æ˜¯å‹ç¼©css,å¹¶ä¸”æŠŠcssä¸­çš„â€background: url(xxxx.png)â€ä¸­çš„â€xxxx.pngâ€è½¬æ¢æˆbase64ç¼–ç çš„å½¢å¼,å‡å°‘httpè¯·æ±‚æ•°ã€‚</p>
<pre><code>&quot;use strict&quot;;

const through = require(&quot;through2&quot;),
    path = require(&quot;path&quot;),
    fs = require(&quot;fs&quot;),

    //  å¼•ç”¨async/await,æ–¹ä¾¿å¤„ç†æ–‡ä»¶è¯»å†™çš„å¼‚æ­¥æ“ä½œ
    async = require(&quot;asyncawait&quot;).async,
    await = require(&quot;asyncawait&quot;).await,

    //  åŒ¹é…url(../xxx.yyy)è¿™ç§è¡¨è¾¾å¼
    imgReg = /url\s*\((\s*[A-Za-z0-9\-\_\.\/\:]+\s*)\);?/gi,

    //  å°†fs.readFileå°è£…æˆPromise
    readFile = (path) =&gt; {
        return new Promise((resolve, reject) =&gt; {
            fs.readFile(path, (ex, file) =&gt; {
                if (ex) {
                    reject(ex);
                }
                resolve(file);
            });
        });
    };

let base, contents, match, tmp, url;

//  æš´éœ²å‡ºå»çš„å‡½æ•°
module.exports = (opt) =&gt; {

    return through.obj(function(file, enc, cb) {

        //  æ–‡ä»¶ä¸ºç©ºç›´æ¥æ‰§è¡Œå›è°ƒå‡½æ•°
        if (file.isNull()) {
            cb(null, file);
        }

        //  å–å¾—å½“å‰cssçš„ç»å¯¹è·¯å¾„
        base = file.base;

        //  åŒ¹é…cssä¸­çš„æ— æ•ˆå­—ç¬¦,å¹¶ä¸”è½¬æ¢æˆbuffer
        file.contents = new Buffer(file._contents.toString()
            //  å»æ¢è¡Œç¬¦
            .replace(/\n/gm, &quot;&quot;)

            //  å»&quot;{&quot;ä¹‹ååˆ°ç¬¬ä¸€æ¡æ ·å¼é—´çš„ç©ºç™½å­—ç¬¦
            .replace(/\{\s+/g, &quot;{&quot;)

            //  å»&quot;;&quot;ä¹‹åçš„ç©ºç™½å­—ç¬¦
            .replace(/\;\s+/g, &quot;;&quot;));

        //  å°†æ–‡ä»¶å†…å®¹è½¬æ¢æˆæ™®é€šå­—ç¬¦ä¸²å¹¶ç¼“å­˜
        contents = file.contents.toString();

        //  å–å¾—url(../../xxx.yyy),å¹¶ä¸”ç¼“å­˜
        match = contents.match(imgReg);

        //  async-awaitè¯»å–å›¾ç‰‡æ–‡ä»¶æˆbase64ç¼–ç 
        async(() =&gt; {

            //  éå†ä¹‹å‰çš„ç¼“å­˜é¡¹
            match.forEach((item) =&gt; {

                //  æ‹¼å‡‘æ–‡ä»¶ç»å¯¹è·¯å¾„
                url = item.replace(&quot;url(&quot;, &quot;&quot;).replace(&quot;)&quot;, &quot;&quot;).trim();

                //  ç”¨awaitè¯»å–æ–‡ä»¶,é¿å…åµŒå¥—
                tmp = await (readFile(path.resolve(base, url)));

                //  æ›¿æ¢ä¹‹å‰åŒ¹é…çš„å­—ç¬¦ä¸²
                contents = contents.replace(item, `url(data:image/png;base64,${tmp.toString(&quot;base64&quot;)})`);
            });

            //  æŠŠæ–‡ä»¶å†…å®¹è½¬æˆbuffer
            file.contents = new Buffer(contents);

            //  å›è°ƒå‡½æ•°
            cb(null, file);

        })();
    });

};
</code></pre><p>è‡³æ­¤,ä¸€ä¸ªç®€å•çš„æ’ä»¶å°±å®ç°äº†,å½“ç„¶,è¿˜æœ‰å¾ˆå¤šä¸è¶³,æ¯”å¦‚å¯¹å›¾ç‰‡è¿›è¡Œå‹ç¼©,å‡å°‘base64å­—ç¬¦ä¸²çš„é•¿åº¦,ç”¨requestæ¨¡å—å¤„ç†å¯¹ç½‘ç»œå›¾ç‰‡çš„å¼•ç”¨ç­‰ç­‰ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ç½‘é¡µç«¯åŠŸèƒ½è¶Šæ¥è¶Šç¹æ‚çš„ä»Šå¤©,éšç€åŠŸèƒ½çš„å¢å¤š,ä»£ç é‡ä¹Ÿå¿…ä¸å¯å°‘çš„å¤šä¸ª,ä»£ç é‡ä¸€å¤š,webæ€§èƒ½å°±æ˜¾å¾—å°¤ä¸ºé‡è¦,å°¤å…¶æ˜¯åŠ è½½æ–¹é¢,æ—¶é—´å¤ªé•¿,å¯èƒ½ç”¨æˆ·å°±æ²¡å¿ƒæƒ…ç­‰ä¸‹å»,æ‰€ä»¥ç°åœ¨çš„webé¡¹ç›®ä¸€èˆ¬éƒ½åœ¨å‘å¸ƒçš„æ—¶å€™è¿›è¡Œä¸€ç‰ˆè‡ªåŠ¨æ„å»º,ä»åŸæ¥çš„gruntåˆ°gulp,å†åˆ°ç°åœ¨çš„webpackã€‚&lt;/
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="Gulp" scheme="http://yoursite.com/categories/javascript/Gulp/"/>
    
      <category term="æ„å»ºå·¥å…·" scheme="http://yoursite.com/categories/javascript/Gulp/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/"/>
    
    
  </entry>
  
  <entry>
    <title>javascriptæ¨¡å—åŒ–ç¼–ç¨‹-åŒæ­¥æ¨¡å¼</title>
    <link href="http://yoursite.com/2016/11/29/2016-11-23-js-sync-module-mode/"/>
    <id>http://yoursite.com/2016/11/29/2016-11-23-js-sync-module-mode/</id>
    <published>2016-11-28T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­,ä¸ºäº†ä¾¿äºå¤šäººåä½œå¼€å‘,æˆ‘ä»¬é€šå¸¸éƒ½ä¼šé‡‡ç”¨æ¨¡å—åŒ–å¼€å‘çš„æ¨¡å¼,ä»Šå¤©çœ‹å¼ è£é“­çš„ã€Šjavascriptè®¾è®¡æ¨¡å¼ã€‹çš„æ—¶å€™,çœ‹åˆ°åŒæ­¥æ¨¡å¼è¿™ä¸€ç« ,ç»“åˆè‡ªå·±ä¹‹å‰çš„ç«‹å³,ä¹Ÿæ¥å®ç°ä¸€ä¸ªç®€å•çš„åŒæ­¥æ¨¡å—åŒ–æ¨¡å¼ã€‚</p>
<pre><code>const module = (() =&gt; {

    //  ç¼“å­˜ä¹‹å‰å£°æ˜çš„æ¨¡å—
    let modules = {};

    /**
     * [description]
     * @param  deps     ä¾èµ–åˆ—è¡¨
     * @return Array
     */
    let _loadDeps = (deps) =&gt; {
        return deps.map((dep) =&gt; {
            return modules[dep];
        });
    };

    return {

        /**
         * å£°æ˜ä¸€ä¸ªæ¨¡å—
         * @param   id      æ¨¡å—id
         * @param   deps    ä¾èµ–æ•°ç»„(æ¨¡å—id)
         * @param   factory æ„é€ å‡½æ•°
         */
        define: (id, deps, factory) =&gt; {

            //  è·å–ä¾èµ–,å¹¶ä¸”å–å¾—æ¨¡å—è¿”å›çš„å¯¹è±¡
            deps = _loadDeps(deps);

            deps.map(function(dep) {
                return dep.factory.apply(window, dep.deps);
            });

            //  åˆ¤æ–­æ¨¡å—åæ˜¯å¦é‡å¤
            if (modules[id]) {
                 throw new Error(&quot;module &quot; + id + &quot; has been declared!&quot;);
            }

            //  ç¼“å­˜æ¨¡å—
            modules[id] = {
                id: id,
                factory: factory,
                deps: deps
            };
        },

        /**
         * ä½¿ç”¨å®šä¹‰å¥½çš„æ¨¡å—
         * @param   depArr  ä¾èµ–æ•°ç»„(æ¨¡å—id)
         * @param   factory æ„é€ å‡½æ•°
         */
        use: (depArr, factory) =&gt; {

            //  è·å–ä¾èµ–,å¹¶ä¸”å–å¾—æ¨¡å—è¿”å›çš„å¯¹è±¡
            depArr = depArr.map((dep) =&gt; {
                return modules[dep].factory.apply(window, modules[dep].deps);
            });

            //  è¿è¡Œæ„é€ å‡½æ•°
            factory.apply(window, depArr);
        }

    };

})();
</code></pre><p>ä¸‹é¢æˆ‘ä»¬å£°æ˜å‡ ä¸ªæ¨¡å—åšæµ‹è¯•:</p>
<pre><code>//  Aæ¨¡å—
module.define(&quot;A&quot;, [], () =&gt; {
    return {
        method: () =&gt; {
            console.log(&quot;method under module A&quot;);
        }
    };
});

//  Bæ¨¡å—
module.define(&quot;B&quot;, [], () =&gt; {
    return {
        method: () =&gt; {
            console.log(&quot;method under module B&quot;);
        }
    };
});

//  Personç±»
module.define(&quot;PersonClass&quot;, [], () =&gt; {

    class Person {
        constructor(name, age, sex, job) {
            this.name = name;
            this.age = age;
            this.sex = sex;
            this.job = job;
        }

        hello() {
            console.log(&quot;hello &quot; + this.name);
        }

        eat() {
            console.log(this.name + &quot; will eat&quot;);
        }

        getProfile() {
            return {
                name: this.name,
                age: this.age,
                sex: this.sex,
                job: this.job
            };
        }
    }

    return Person;
});
</code></pre><p>æœ€åæˆ‘ä»¬è°ƒç”¨module.useæ¥ä½¿ç”¨è¿™äº›æ¨¡å—:</p>
<pre><code>module.use([&quot;A&quot;, &quot;B&quot;, &quot;PersonClass&quot;], (A, B, PersonClass) =&gt; {

    A.method();
    B.method();

    let person = new PersonClass(&quot;rwson&quot;, 24, &quot;male&quot;, &quot;web developer&quot;);
    person.hello();

    setTimeout(function() {
        person.eat();
    }, 5000);

    console.log(person.getProfile());

});
</code></pre><p>æœ€åæµè§ˆå™¨æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹å›¾çš„ç»“æœ:</p>
<p><img src="/imgs/sync-module-mode.png" alt="javascriptæ¨¡å—åŒ–-åŒæ­¥æ¨¡å¼"></p>
<p>è‡³æ­¤ä¸€ä¸ªç®€å•çš„æ¨¡å—åŒ–å·¥å…·å°±å¼€å‘å®Œæˆäº†ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨æ—¥å¸¸å¼€å‘ä¸­,ä¸ºäº†ä¾¿äºå¤šäººåä½œå¼€å‘,æˆ‘ä»¬é€šå¸¸éƒ½ä¼šé‡‡ç”¨æ¨¡å—åŒ–å¼€å‘çš„æ¨¡å¼,ä»Šå¤©çœ‹å¼ è£é“­çš„ã€Šjavascriptè®¾è®¡æ¨¡å¼ã€‹çš„æ—¶å€™,çœ‹åˆ°åŒæ­¥æ¨¡å¼è¿™ä¸€ç« ,ç»“åˆè‡ªå·±ä¹‹å‰çš„ç«‹å³,ä¹Ÿæ¥å®ç°ä¸€ä¸ªç®€å•çš„åŒæ­¥æ¨¡å—åŒ–æ¨¡å¼ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;const module = (() =&amp;g
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="æ¨¡å—åŒ–" scheme="http://yoursite.com/categories/javascript/%E6%A8%A1%E5%9D%97%E5%8C%96/"/>
    
    
  </entry>
  
  <entry>
    <title>async/awaitå­¦ä¹ </title>
    <link href="http://yoursite.com/2016/11/09/2016-11-09-async:await-tourial/"/>
    <id>http://yoursite.com/2016/11/09/2016-11-09-async:await-tourial/</id>
    <published>2016-11-08T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å¤„ç†javascriptä¸­å¼‚æ­¥çš„æ—¶å€™,å›è°ƒå¾€å¾€æ˜¯æœ€è®©äººæ¶å¿ƒçš„,ä¹‹å‰ä»‹ç»è¿‡ç”¨<a href="http://123.207.98.169:81/2016/05/04/2016-05-04-es6-promise/" target="_blank" rel="external">Promise</a>æ¥å¤„ç†å¼‚æ­¥çš„é—®é¢˜,ä½†æ˜¯å³ä½¿ç”¨ä¸Šäº†Promise,åœ¨å¤„ç†å›è°ƒä¸Šè¿˜æ˜¯ä¼šæœ‰å„ç§åµŒå¥—,ä»Šå¤©æ¥ä»‹ç»ä¸‹ES7ä¸­çš„async/await,ç”±äºåœ¨Nodejsä¸­è¿˜æœªå¾—åˆ°æ”¯æŒ,æ‰€ä»¥éœ€è¦å€ŸåŠ©ä¸€äº›npmåŒ…æ¥å®è·µ,åœ¨è¿™é‡Œç”¨çš„æ˜¯<a href="https://github.com/yortus/asyncawait" target="_blank" rel="external">asyncawait</a>ã€‚</p>
<p>å…ˆæ¥ä¸ªåŸç”Ÿæ–‡ä»¶è¯»å–çš„ä¾‹å­:</p>
<pre><code>const fs = require(&quot;fs&quot;);
fs.readFile(&quot;test.txt&quot;, (ex, res) =&gt; {
   console.log(res.toString()); 

   //   do something...

   fs.readFile(&quot;test2.txt&quot;, (ex, res) =&gt; {
        console.log(res.toString());

        //  do something
   });
});

//  æ§åˆ¶å°è¾“å‡º
xxxxx
yyyyy
</code></pre><p>ä¸‹é¢æˆ‘ä»¬å†ç”¨async/awaitå®ç°ä¸€é:</p>
<pre><code>const async = require(&quot;asyncawait&quot;).async;
const await = require(&quot;asyncawait&quot;).await;
let readFile = function(path) {
    return new Promise((resolve, reject) =&gt; {
        fs.readFile(path, (ex, res) =&gt; {
            if (ex) {
                reject(ex);
            }
            resolve(res);
        });
    });
}

let asyncReadFile = async(() =&gt; {

    let fs = await (readFile(&quot;test.txt&quot;));
    let fs2 = await (readFile(&quot;test2.txt&quot;));

    console.log(fs.toString());
    console.log(fs2.toString());
});

asyncReadFile();
</code></pre><p>è™½ç„¶ä»£ç å¯èƒ½æ¯”ä¸Šé¢çš„å¤šäº†ä¸€ç‚¹,ä½†æ˜¯å·²ç»å®Œå…¨çœ‹ä¸åˆ°å›è°ƒåµŒå¥—çš„å½±å­äº†,ä¹Ÿèƒ½å®ŒæˆåŒæ ·çš„åŠŸèƒ½,ä½•ä¹è€Œä¸ä¸ºã€‚ğŸ˜‰</p>
<p>ä¸‹é¢æˆ‘ä»¬å†æ¥æ¨¡æ‹Ÿä¸€ä¸ªå¼‚æ­¥è¯·æ±‚çš„ä¾‹å­:</p>
<pre><code>const async = require(&quot;asyncawait&quot;).async;
const await = require(&quot;asyncawait&quot;).await;
const http = require(&quot;http&quot;);

http.createServer((req, res) =&gt; {

    switch (req.url) {

        case &quot;/async-await&quot;:
            setTimeout(() =&gt; {
                res.writeHead(200, { &quot;Content-Type&quot;: &quot;text/plain&quot; });
                res.end(&quot;request end&quot;);
            }, 5000);
            break;

        case &quot;/async-await2&quot;:
            setTimeout(() =&gt; {
                res.writeHead(200, { &quot;Content-Type&quot;: &quot;text/plain&quot; });
                res.end(&quot;request end2&quot;);
            }, 8000);
            break;

        default:
            break;

    }
}).listen(3000, &quot;127.0.0.1&quot;);

let requestUrl = function(path) {
    return new Promise((resolve, reject) =&gt; {
        http.get({
            hostname: &apos;localhost&apos;,
            port: 3000,
            path: path,
            agent: false
        }, (res) =&gt; {
            res.on(&quot;data&quot;, (data) =&gt; {
                resolve(data);
            });
            res.on(&quot;error&quot;, (ex) =&gt; {
                reject(ex);
            })
        });
    });
}

let asyncRequest = async(() =&gt; {
    let resp, resp2;
    await (requestUrl(&quot;/async-await&quot;).then((res) =&gt; {
        console.log(res.toString());
        resp = res.toString();
    }).catch((ex) =&gt; {
        resp = &quot;å‘ç”Ÿé”™è¯¯!&quot;;
    }));

    await (requestUrl(&quot;/async-await2&quot;).then((res) =&gt; {
        resp2 = res.toString();
    }).catch((ex) =&gt; {
        resp = &quot;å‘ç”Ÿé”™è¯¯!&quot;;
    }));
    console.log(resp);
    console.log(resp2);
});

asyncRequest();

//  æ§åˆ¶å°è¾“å‡º
request end
request end2
</code></pre><p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥å°†async/awaitç”¨åœ¨å¾ˆå¤šåœ°æ–¹,æ¯”å¦‚ä¾‹å­ä¸­çš„æ–‡ä»¶è¯»å–ã€å¼‚æ­¥è¯·æ±‚ã€nodejsä¸­çš„æŸ¥è¯¢æ•°æ®åº“ç­‰ç­‰ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨å¤„ç†javascriptä¸­å¼‚æ­¥çš„æ—¶å€™,å›è°ƒå¾€å¾€æ˜¯æœ€è®©äººæ¶å¿ƒçš„,ä¹‹å‰ä»‹ç»è¿‡ç”¨&lt;a href=&quot;http://123.207.98.169:81/2016/05/04/2016-05-04-es6-promise/&quot; target=&quot;_blank&quot; rel=&quot;external
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="ES7" scheme="http://yoursite.com/categories/javascript/ES7/"/>
    
      <category term="async/await" scheme="http://yoursite.com/categories/javascript/ES7/async-await/"/>
    
    
  </entry>
  
  <entry>
    <title>IEä¸‹AngularJsä¸­çš„ajaxç¼“å­˜</title>
    <link href="http://yoursite.com/2016/11/02/2016-11-02-ie-ajax-cache/"/>
    <id>http://yoursite.com/2016/11/02/2016-11-02-ie-ajax-cache/</id>
    <published>2016-11-01T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å•é¡µåº”ç”¨è¶Šæ¥è¶Šæ™®åŠçš„ä»Šå¤©,è¶Šæ¥è¶Šå¤šçš„é¡¹ç›®éƒ½ä¼šé‡‡ç”¨è¿™ç§æ–¹æ¡ˆ,è¿™å‡ å¤©ç”¨AngularJsåšäº†ä¸€ä¸ªPCç«¯åº”ç”¨,æœ‰ç™»å½•æ³¨å†Œçš„åŠŸèƒ½,ç™»å½•æ³¨å†Œçš„åŠŸèƒ½æ˜¯é€šè¿‡ajaxå®ç°çš„,åœ¨ç™»å½•æ³¨å†Œä»¥åé¡µé¢ä¸åˆ·æ–°,åªä¿®æ”¹$rootScopeä¸‹çš„æŸäº›å±æ€§å€¼,ç„¶ååœ¨é¡µé¢é‡Œé¢é€šè¿‡ng-ifä¹‹ç±»çš„æŒ‡ä»¤æ¥æ§åˆ¶ç›¸å…³å…ƒç´ çš„æ˜¾ç¤ºéšè—ã€‚</p>
<p>ä¹‹å‰çš„å¤§æ¦‚å®ç°å¦‚ä¸‹:</p>
<pre><code>//  js
var app = angular.module(&quot;app&quot;, []);
app.run([&quot;$rootScope&quot;, &quot;$http&quot;, function($rootScope, $http) {
    $rootScope.isLogin = false;
    $rootScope.$on(&quot;$routeChangeStart&quot;, function (event, next, current) {
    $http.get(&quot;xxxx&quot;)
        .success(function(res) {
            $rootScope.isLogin = !!(res.isLogin);
            //  ...
        })
        .error(function() {
            //  ...
        });
    });
}]);

//  HTML
&lt;div class=&quot;container&quot;&gt;
    &lt;a href=&quot;/user/center&quot; ng-if=&quot;isLogin&quot;&gt;ç”¨æˆ·ä¸­å¿ƒ&lt;/a&gt;
    &lt;a href=&quot;javascript:;&quot; ng-click=&quot;logout()&quot; ng-if=&quot;isLogin&quot;&gt;ç™»å‡º&lt;/a&gt;
    &lt;a href=&quot;/login&quot; ng-if=&quot;!isLogin&quot;&gt;ç™»å½•&lt;/a&gt;
&lt;/div&gt;
</code></pre><p>åæ¥å‘ç°åœ¨Chrome/Firefoxä¸‹éƒ½æ˜¯å¥½çš„,åˆ°äº†IEä¸‹ç™»å½•ä»¥åä¸åˆ·æ–°å°±æ˜¾ç¤ºä¸å¯¹ã€‚åŸæ¥ä»¥ä¸ºæ˜¯ng-ifåœ¨IEä¸‹é‡æ–°æ¸²æŸ“è¿‡æ…¢çš„é—®é¢˜,æ”¹æˆng-showä»¥åè¿˜æ˜¯ä¸è¡Œ,ç„¶åçœ‹httpçŠ¶æ€ç ,å‘ç°æ˜¯304,æƒ³åˆ°å¯èƒ½å’Œç¼“å­˜æœ‰å…³ç³»,åæ¥æ”¹äº†é…ç½®ä¸­å…³é”®ajaxè¯·æ±‚é‚£è¾¹çš„ä¸œè¥¿,å‘ç°å¯ä»¥äº†,æ ¸å¿ƒä»£ç å¦‚ä¸‹:</p>
<pre><code>app.config([&quot;$routeProvider&quot;, &quot;$httpProvider&quot;, function($routeProvider, $httpProvider){
    //  ...

    if (!$httpProvider.defaults.headers.get) {
        $httpProvider.defaults.headers.get = {};
    }
    $httpProvider.defaults.headers.common[&quot;X-Requested-With&quot;] = &quot;XMLHttpRequest&quot;;
    $httpProvider.defaults.headers.get[&quot;Cache-Control&quot;] = &quot;no-cache&quot;;
    $httpProvider.defaults.headers.get[&quot;Pragma&quot;] = &quot;no-cache&quot;;
}]);
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨å•é¡µåº”ç”¨è¶Šæ¥è¶Šæ™®åŠçš„ä»Šå¤©,è¶Šæ¥è¶Šå¤šçš„é¡¹ç›®éƒ½ä¼šé‡‡ç”¨è¿™ç§æ–¹æ¡ˆ,è¿™å‡ å¤©ç”¨AngularJsåšäº†ä¸€ä¸ªPCç«¯åº”ç”¨,æœ‰ç™»å½•æ³¨å†Œçš„åŠŸèƒ½,ç™»å½•æ³¨å†Œçš„åŠŸèƒ½æ˜¯é€šè¿‡ajaxå®ç°çš„,åœ¨ç™»å½•æ³¨å†Œä»¥åé¡µé¢ä¸åˆ·æ–°,åªä¿®æ”¹$rootScopeä¸‹çš„æŸäº›å±æ€§å€¼,ç„¶ååœ¨é¡µé¢é‡Œé¢é€šè¿‡ng-ifä¹‹ç±»çš„æŒ‡ä»¤æ¥æ§åˆ¶ç›¸
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="AngularJs" scheme="http://yoursite.com/categories/javascript/AngularJs/"/>
    
      <category term="ajax" scheme="http://yoursite.com/categories/javascript/AngularJs/ajax/"/>
    
    
  </entry>
  
  <entry>
    <title>javascriptä¸­çš„åºåˆ—åŒ–</title>
    <link href="http://yoursite.com/2016/09/17/2016-09-17-javascript-serialize/"/>
    <id>http://yoursite.com/2016/09/17/2016-09-17-javascript-serialize/</id>
    <published>2016-09-16T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ç”¨jQueryå‘é€ajax(POST)è¯·æ±‚çš„æ—¶å€™,æœ€å¸¸è§çš„æäº¤æ–¹å¼å°±æ˜¯â€application/x-www-form-urlencodedâ€,é€šå¸¸éƒ½ä¼šä¼ å…¥ä¸€ä¸ªdataå±æ€§ä½œä¸ºä¼ è¾“ç»™åç«¯çš„æ•°æ®,åœ¨ajaxå‘é€ä¹‹å‰,é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥å¦‚æœç›´æ¥ä¼ å…¥æŠŠè¿™ä¸ªå¯¹è±¡ä¼ é€’ç»™åç«¯,åç«¯å°±ä¸èƒ½å¯¹è¯¥å¯¹è±¡è¿›è¡Œè§£æ,å› ä¸ºå¯¹è±¡ä¼šè¢«è½¬æˆå­—ç¬¦ä¸²â€[object Object]â€,æ‰€ä»¥å°±éœ€è¦æˆ‘ä»¬å¯¹è¯¥å¯¹è±¡è¿›è¡Œurlç¼–ç ,å¹¶ä¸”è½¬æ¢æˆå­—ç¬¦ä¸²,å†ä¼ ç»™åç«¯ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬å…ˆä¼ é€’ä¸€ä¸ªç®€å•çš„å¯¹è±¡(æ‰€æœ‰çš„keyå¯¹åº”çš„valueéƒ½ä¸æ˜¯å¼•ç”¨ç±»å‹[Arrayã€Object]),å°±åƒä¸‹é¢è¿™æ ·:</p>
<pre><code>{
    string: &quot;string&quot;,
    number: 1
}
</code></pre><p>ç”¨jQueryä¸­çš„$.ajaxæ–¹æ³•,POSTæäº¤,æ‰“å¼€è¯·æ±‚é¢æ¿,åœ¨form dataé‚£è¾¹,ç‚¹å‡»view source,å¯ä»¥çœ‹åˆ°ä¸‹é¢è¿™ä¸€ä¸²å­—ç¬¦ä¸²,å°±åƒä¸‹é¢çš„æ ·å­:</p>
<pre><code>string=string&amp;number=1
</code></pre><p>åœ¨jQueryä¸­,$.paramè¿™ä¸ªæ–¹æ³•å¯ä»¥å®ç°è¿›è¡Œurlç¼–ç çš„ä½œç”¨ã€‚</p>
<p>ç°åœ¨å¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ª:</p>
<pre><code>//  è·å–å¯¹è±¡ä¸Šçš„ç±»å
function _typeOf(obj) {
    return {}.toString.call(obj).slice(8, -1);
}

//  encodeURIComponentç®€å†™
function _encode(data) {
    data = data || &quot;&quot;;
    return encodeURIComponent(data);
}

//  åºåˆ—åŒ–ä¸»å‡½æ•°
function _serializenData(data) {
    var res = data,
        typeIn;

    //  åˆ¤æ–­ä¼ å…¥çš„æ˜¯å¦æ˜¯ä¸€ä¸ªObjectç±»å‹çš„æ•°æ®
    if (_typeOf(data) === &quot;Object&quot;) {
        res = [];
        for (var i in data) {
            typeIn = _typeOf(data[i]);
            switch (typeIn) {

                //  é‡åˆ°Objectã€Arrayæ—¶éœ€è¦è¿›è¡Œéå†æˆ–è€…æšä¸¾,å¯¹å…¶å†…éƒ¨å…ƒç´ ã€å±æ€§åšå¤„ç†åå†æ”¾åˆ°ç»“æœé›†æ•°ç»„ä¸­
                case &quot;Object&quot;:
                    res.push(_loopObject(data[i], i));
                    break;

                case &quot;Array&quot;:
                    res.push(_loopArray(data[i], i));
                    break;

                //  å…¶ä»–ç±»å‹ç›´æ¥æ¨åˆ°ç»“æœé›†æ•°ç»„
                default:
                    res.push(_encode(i) + &quot;=&quot; + _encode(data[i]));
                    break;

            }
        }
        //  æŠŠç»“æœé›†æ•°ç»„è½¬æ¢æˆ&quot;xxx=111&amp;yyy=333&amp;zzz=444&quot;çš„å½¢å¼
        res = res.join(&quot;&amp;&quot;).replace(&quot;%20&quot;, &quot;+&quot;)
    }
    return (&quot;&quot; + res);
}

/**
 * æ·±å±‚éå†ä¸€ä¸ªæ•°ç»„
 * @param  {[type]} array [description]
 * @param  {[type]} key   [description]
 * @return {[type]}       [description]
 */
function _loopArray(array, key) {
    var res = [],
        typeIn;
    for (var i = 0, len = array.length; i &lt; len; i++) {

        //  è·å–æ¯ä¸€é¡¹çš„ç±»å,å¦‚æœæ˜¯Object/åˆ™é€’å½’è°ƒç”¨_loopArray/_loopObject,ä¼ å…¥å½“å‰é¡¹å’Œå±æ€§å,å¤„ç†å­é¡¹,å†æ”¾åˆ°ç»“æœé›†ä¸­
        typeIn = _typeOf(array[i]);
        switch (typeIn) {

            case &quot;Array&quot;:
                res.push(_loopArray(array[i], (key + &quot;[&quot; + i + &quot;]&quot;)));
                break;

            case &quot;Object&quot;:
                res.push(_loopObject(array[i], (key + &quot;[&quot; + i + &quot;]&quot;)));
                break;

            //    å…¶ä»–ç±»å‹çš„ç›´æ¥æ¨åˆ°ç»“æœé›†æ•°ç»„
            default:
                res.push(_encode(key + &quot;[]&quot;) + &quot;=&quot; + _encode((&quot;&quot; + array[i])));
                break;

        }
    }

    //  æŠŠç»“æœé›†è½¬æ¢æˆ&quot;xxx=111&amp;yyy=333&amp;zzz=444&quot;çš„å½¢å¼
    return res.join(&quot;&amp;&quot;);
}

/**
 * æ·±å±‚éå†ä¸€ä¸ªå¯¹è±¡
 * @param  {[type]} object [description]
 * @param  {[type]} key    [description]
 * @return {[type]}        [description]
 */
function _loopObject(object, key) {
    var res = [],
        typeIn;
    for (var i in object) {
        //  å–å¾—ä¸€ä¸ªå½“å‰keyå¯¹åº”valueçš„ç±»å,å¦‚æœæ˜¯Object/Array,åˆ™è¿›è¡Œé€’å½’è°ƒç”¨
        typeIn = _typeOf(object[i]);
        switch (typeIn) {
            case &quot;Array&quot;:
                res.push(_loopArray(object[i], key + &quot;[&quot; + i + &quot;]&quot;));
                break;

            case &quot;Object&quot;:
                res.push(_loopObject(object[i], key + &quot;[&quot; + i + &quot;]&quot;));
                break;

            //    å…¶ä»–ç±»å‹çš„ç›´æ¥æ¨åˆ°ç»“æœé›†æ•°ç»„ä¸­
            default:
                res.push(_encode(key + &quot;[&quot; + i + &quot;]&quot;) + &quot;=&quot; + _encode((&quot;&quot; + object[i])));
                break;
        }
    }

    //  æŠŠç»“æœé›†è½¬æ¢æˆ&quot;xxx=111&amp;yyy=333&amp;zzz=444&quot;çš„å½¢å¼
    return res.join(&quot;&amp;&quot;);
}
</code></pre><p>ä¸‹é¢æˆ‘ä»¬æ¨¡æ‹Ÿå‡ ä¸ªå¤æ‚ç‚¹çš„å¯¹è±¡,è°ƒç”¨å°è£…çš„åºåˆ—åŒ–æ–¹æ³•,å’Œ$.paramè¿›è¡Œå¯¹æ¯”:</p>
<pre><code>var obj = {
    string: &quot;string&quot;,
    number: 1,
    array: [1, 2, 3, 4, 5]
};

var obj2 = {
    string: &quot;string&quot;,
    number: 1,
    array: [
        1, 2, 3, 4, 5, {
            key1: &quot;value1&quot;,
            key2: &quot;value2&quot;,
            key3: &quot;value3&quot;
        }
    ]
};

var obj3 = {
    array: [1, 2, 3, 4, 5],
    arrayobject: [{
        key1: &quot;value1&quot;,
        key2: &quot;value2&quot;,
        key3: &quot;value3&quot;
    }, {
        key1: &quot;value1&quot;,
        key2: &quot;value2&quot;,
        key3: &quot;value3&quot;
    }, {
        key1: &quot;value1&quot;,
        key2: &quot;value2&quot;,
        key3: &quot;value3&quot;
    }]
};

var deepObj1 = {
    arr: [{
        string: &quot;string&quot;,
        number: 1,
        arr: [1, 2, 3, 4],
        mixArr: [{
            key1: &quot;value1&quot;,
            key2: &quot;value2&quot;
        }, {
            key1: &quot;value1&quot;,
            key2: &quot;value2&quot;
        }, {
            key1: &quot;value1&quot;,
            key2: &quot;value2&quot;
        }]
    }]
};

var deepObj2 = {
    obj: {
        key1: &quot;value1&quot;,
        key2: &quot;value2&quot;,
        key3: &quot;value3&quot;
    },
    array: [1, 2, 3, 4, 5],
    objectArray: {
        array: [1, 2, 3, 4, 5, {
            key1: &quot;value1&quot;,
            key2: &quot;value2&quot;,
            key3: &quot;value3&quot;
        }]
    },
    arrayObj: [{
        key1: &quot;value1&quot;,
        key2: &quot;value2&quot;,
        key3: &quot;value3&quot;
    }, {
        key1: &quot;value1&quot;,
        key2: &quot;value2&quot;,
        key3: &quot;value3&quot;
    }, {
        key1: &quot;value1&quot;,
        key2: &quot;value2&quot;,
        key3: &quot;value3&quot;
    }]
};

//  æ‰“å¼€æ§åˆ¶å°çš„consoleé¢æ¿,æŸ¥çœ‹è¾“å‡º

console.group(&quot;serialize obj&quot;);
console.log(_serializenData(obj));  //  ...
console.log($.param(obj));  //  ...
console.log(_serializenData(obj) === $.param(obj)); //  true
console.groupEnd();

console.group(&quot;serialize obj2&quot;);
console.log(_serializenData(obj2)); //  ...
console.log($.param(obj2)); //  ...
console.log(_serializenData(obj2) === $.param(obj2));   //  true
console.groupEnd();    

console.group(&quot;serialize obj3&quot;);
console.log(_serializenData(obj3)); //  ...
console.log($.param(obj3)); //  ...
console.log(_serializenData(obj3) === $.param(obj3));   //  true
console.groupEnd();

console.group(&quot;serialize deepObj1&quot;);
console.log(_serializenData(deepObj1)); //  ...
console.log($.param(deepObj1)); //  ...
console.log(_serializenData(deepObj1) === $.param(deepObj1));   //  true
console.groupEnd();

console.group(&quot;serialize deepObj2&quot;);
console.log(_serializenData(deepObj2)); //  ...
console.log($.param(deepObj2)); //  ...
console.log(_serializenData(deepObj2) === $.param(deepObj2));   //  true
console.groupEnd();
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ç”¨jQueryå‘é€ajax(POST)è¯·æ±‚çš„æ—¶å€™,æœ€å¸¸è§çš„æäº¤æ–¹å¼å°±æ˜¯â€application/x-www-form-urlencodedâ€,é€šå¸¸éƒ½ä¼šä¼ å…¥ä¸€ä¸ªdataå±æ€§ä½œä¸ºä¼ è¾“ç»™åç«¯çš„æ•°æ®,åœ¨ajaxå‘é€ä¹‹å‰,é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥å¦‚æœç›´æ¥ä¼ å…¥æŠŠè¿™ä¸ªå¯¹è±¡ä¼ é€’ç»™åç«¯,åç«¯å°±ä¸èƒ½å¯¹è¯¥
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="åºåˆ—åŒ–" scheme="http://yoursite.com/categories/javascript/%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
    
  </entry>
  
  <entry>
    <title>javascriptä¸­Dateç»†èŠ‚</title>
    <link href="http://yoursite.com/2016/08/30/2016-08-30-something-about-javascript-Date/"/>
    <id>http://yoursite.com/2016/08/30/2016-08-30-something-about-javascript-Date/</id>
    <published>2016-08-29T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<h5 id="Safriæµè§ˆå™¨new-Date-â€œyyyy-mm-ddâ€-è¿”å›invalid-Date"><a href="#Safriæµè§ˆå™¨new-Date-â€œyyyy-mm-ddâ€-è¿”å›invalid-Date" class="headerlink" title="Safriæµè§ˆå™¨new Date(â€œyyyy-mm-ddâ€)è¿”å›invalid Date"></a>Safriæµè§ˆå™¨new Date(â€œyyyy-mm-ddâ€)è¿”å›invalid Date</h5><p>è®¸å¤šæ—¶å€™æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–ä¸€ä¸ªå…·ä½“æŸå¤©çš„æ—¥æœŸå¯¹è±¡çš„æ—¶å€™,ä¼šç”¨åˆ°new Date(),è¿™ä¸ªæ–¹æ³•,æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°æ¥æŒ‡å®šå…·ä½“çš„æ—¥æœŸ,è€Œä¸€èˆ¬æˆ‘ä»¬ä¼šä¼ å…¥ä¸€ä¸ªâ€yyyy-mm-dd hh:ii:ssâ€è¿™ç§æ ¼å¼ä½œä¸ºä¸€ä¸ªåˆå§‹æ—¥æœŸ,ä½†åˆ°äº†Safriæµè§ˆå™¨ä¸‹,å°±ä¼šè¿”å›ä¸€ä¸ªinvalid Date,è°ƒç”¨è¯¥Dateå®ä¾‹ä¸‹çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¼šè¿”å›NaNå€¼,åŸå› æ˜¯Safriä¸èƒ½æ­£å¸¸è§£æä¸­é—´çš„â€-â€œåˆ†éš”ç¬¦,è§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•,æœ‰ä¸¤ç§:</p>
<p>ç›´æ¥</p>
<pre><code>var myDate1 = Date.parseExact(&quot;29-11-2010&quot;, &quot;dd-MM-yyyy&quot;);
var myDate2 = Date.parseExact(&quot;11-29-2010&quot;, &quot;MM-dd-yyyy&quot;);
var myDate3 = Date.parseExact(&quot;2010-11-29&quot;, &quot;yyyy-MM-dd&quot;);
var myDate4 = Date.parseExact(&quot;2010-29-11&quot;, &quot;yyyy-dd-MM&quot;);
</code></pre><p>æˆ–è€…</p>
<pre><code>new Date(&quot;2011-04-12&quot;.replace(/-/g, &quot;/&quot;));
</code></pre><h5 id="setMonthæº¢å‡ºé—®é¢˜"><a href="#setMonthæº¢å‡ºé—®é¢˜" class="headerlink" title="setMonthæº¢å‡ºé—®é¢˜"></a>setMonthæº¢å‡ºé—®é¢˜</h5><p>å®ä¾‹åŒ–ä¸€ä¸ªDateå¯¹è±¡,é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼,ç„¶åè°ƒç”¨è¯¥å®ä¾‹çš„setMonthæ–¹æ³•,æŠŠå½“å‰æœˆä»½åŠ 1,å°±åƒä¸‹é¢è¿™æ ·</p>
<pre><code>var date = new Date(&quot;2016/01/30&quot;);
date.setMonth(date.getMonth() + 1);
console.log(date.getMonth());       //  Tue Mar 01 2016 00:00:00 GMT+0800 (CST)
</code></pre><p>æˆ–è€…</p>
<pre><code>var date = new Date(&quot;2016/10/31&quot;);
date.setMonth(date.getMonth() + 1);
console.log(date);                 //  Thu Dec 01 2016 00:00:00 GMT+0800 (CST)
</code></pre><p>ä¸Šé¢ä¸¤æ®µæˆ‘ä»¬éƒ½å¸Œæœ›æ˜¯è¿”å›çš„æ˜¯2æœˆå’Œ11æœˆ,ä½†æ˜¯çœŸæ­£è¿”å›äº†3æœˆå’Œ12æœˆ</p>
<p>å‡ºç°è¿™ç§æƒ…å†µçš„åŸå› æ˜¯2æœˆæ²¡æœ‰28/29å·ä»¥åçš„æ—¥æœŸ,è€Œå½“å‰æ—¥æœŸå¯¹è±¡çš„æ—¥æœŸä¸º30å·,è°ƒç”¨setMonth,å°±å¯¼è‡´æº¢å‡º,ä¸‹é¢çš„ä¾‹å­åŒç†ã€‚</p>
<p>è§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•,åœ¨è°ƒç”¨setMonthä¹‹å‰,æ‹¿ä¸‹ä¸ªæœˆçš„æœ€åä¸€å¤©å’Œå½“å‰çš„æ¯”è¾ƒä¸‹,å†åšç›¸åº”å¤„ç†å°±å¥½,æˆ–è€…æ›´ç®€å•ç²—æš´çš„æ–¹æ³•,æŠŠå½“å‰Dateå¯¹è±¡çš„dateæ”¹æˆ1,å“ˆå“ˆã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;Safriæµè§ˆå™¨new-Date-â€œyyyy-mm-ddâ€-è¿”å›invalid-Date&quot;&gt;&lt;a href=&quot;#Safriæµè§ˆå™¨new-Date-â€œyyyy-mm-ddâ€-è¿”å›invalid-Date&quot; class=&quot;headerlink&quot; title=&quot;Safr
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="Date" scheme="http://yoursite.com/categories/javascript/Date/"/>
    
    
  </entry>
  
  <entry>
    <title>javascriptå‡½æ•°èŠ‚æµ</title>
    <link href="http://yoursite.com/2016/07/20/2016-07-20-javascript-function-throttle/"/>
    <id>http://yoursite.com/2016/07/20/2016-07-20-javascript-function-throttle/</id>
    <published>2016-07-19T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¦‚æœæˆ‘ä»¬éœ€è¦åšä¸€ä¸ªè¿‡æ»¤çš„åŠŸèƒ½,ç±»ä¼¼äºä¸‹é¢è¿™ä¸ªæ•ˆæœ</p>
<p><img src="/imgs/screen.gif" alt=""></p>
<p>æˆ‘ä»¬éœ€è¦ç»™inputç»‘å®šä¸€ä¸ªkeyupäº‹ä»¶,ç„¶åæ ¹æ®å®ƒçš„valueæ“ä½œé¡µé¢æˆ–è€…è¿‡æ»¤æ•°æ®é‡æ–°æ¸²æŸ“é¡µé¢,ä½†æ˜¯åœ¨æ•°æ®æ¯”è¾ƒå¤šçš„æ—¶å€™,å¦‚æœåœ¨keyupé‡Œé¢ä¸åšä¸€å®šé™åˆ¶çš„è¯,åœ¨æ€§èƒ½æ–¹é¢å°±ä¼šæœ‰ä¸€äº›å½±å“,è¿™æ—¶å€™,å°±éœ€è¦â€å‡½æ•°èŠ‚æµâ€è¿™ä¸ªä¸œè¥¿ã€‚</p>
<p>åœ¨underscoreè¿™ä¸ªåº“ä¸­æä¾›äº†ä¸€ä¸ªå‡½æ•°èŠ‚æµçš„æ–¹æ³•,å…¶å®å°±æ˜¯åœ¨ä¸€å®šæ—¶é—´å†…åˆ¤æ–­æŸä¸ªå‡½æ•°æ˜¯å¦è¢«æ‰§è¡Œè¿‡ã€‚</p>
<p>å°±æ‹¿æˆ‘ä»¬ä¸Šé¢çš„æ•ˆæœæ¥è¯´:</p>
<pre><code>//  HTML
&lt;input type=&quot;text&quot; id=&quot;input&quot; /&gt;
&lt;ul id=&quot;ul&quot;&gt;
    &lt;li&gt;111111111&lt;/li&gt;
    &lt;li&gt;22222222&lt;/li&gt;
    &lt;li&gt;333333&lt;/li&gt;
    &lt;li&gt;4444&lt;/li&gt;
    &lt;li&gt;1234&lt;/li&gt;
    &lt;li&gt;5678&lt;/li&gt;
    &lt;li&gt;9999&lt;/li&gt;
    &lt;li&gt;6789&lt;/li&gt;
    &lt;li&gt;01234&lt;/li&gt;
&lt;/ul&gt;


//  javascript
    window.onload = function() {
        var input = document.getElementById(&quot;input&quot;);
        var ul = document.getElementById(&quot;ul&quot;);
        var li = ul.getElementsByTagName(&quot;li&quot;);
        var len = li.length;
        var value, timeout = null;
        input.onkeyup = function(ev) {
            //  ä¸Šæ¬¡çš„è¿˜æ²¡æ‰§è¡Œ
            if(timeout) {
                return;
            }
            timeout = setTimeout(function() {
                clearTimeout(timeout);
                value = ev.target.value.trim();
                for(var i = 0; i &lt; len; i ++) {
                    if(li[i].innerHTML.indexOf(value) &gt; -1) {
                        li[i].style.display = &quot;block&quot;;
                    } else {
                        li[i].style.display = &quot;none&quot;;
                    }
                }
            }, 200);
        };

};
</code></pre><p>ä¸‹é¢å¯ä»¥æŠŠè¿™ä¸ªå‡½æ•°å†æ¬¡è¿›è¡Œå°è£…:</p>
<pre><code>/**
 * å‡½æ•°èŠ‚æµ
 * @param fn        å›è°ƒå‡½æ•°
 * @param delay     å»¶è¿Ÿå¤šä¹…
 * @param atleast   è‡³å°‘å¤šä¹…è§¦å‘ä¸€æ¬¡
 * @return Function
 */
function throttle(fn, delay, atleast) {
    var timer = null;
    var previous = null;

    return function () {
        var now = +(new Date());

        if ( !previous ) {
            previous = now;
        }

        if ( now - previous &gt; atleast ) {
            fn();
            // é‡ç½®ä¸Šä¸€æ¬¡å¼€å§‹æ—¶é—´ä¸ºæœ¬æ¬¡ç»“æŸæ—¶é—´
            previous = now;
        } else {
            clearTimeout(timer);
            timer = setTimeout(function() {
                fn();
            }, delay);
        }
    }
};
</code></pre><p>åœ¨å¹³æ—¶å¯ä»¥æœ‰å¥½å¤šåœ°æ–¹ç”¨åˆ°å‡½æ•°èŠ‚æµ,æ¯”å¦‚æµè§ˆå™¨çš„resize,é¼ æ ‡æ»šè½®äº‹ä»¶ç­‰ç­‰ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¦‚æœæˆ‘ä»¬éœ€è¦åšä¸€ä¸ªè¿‡æ»¤çš„åŠŸèƒ½,ç±»ä¼¼äºä¸‹é¢è¿™ä¸ªæ•ˆæœ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/imgs/screen.gif&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬éœ€è¦ç»™inputç»‘å®šä¸€ä¸ªkeyupäº‹ä»¶,ç„¶åæ ¹æ®å®ƒçš„valueæ“ä½œé¡µé¢æˆ–è€…è¿‡æ»¤æ•°æ®é‡æ–°æ¸²æŸ“é¡µé¢,ä½†æ˜¯åœ¨æ•°æ®æ¯”è¾ƒå¤šçš„æ—¶å€™,
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="å‡½æ•°èŠ‚æµ" scheme="http://yoursite.com/categories/javascript/%E5%87%BD%E6%95%B0%E8%8A%82%E6%B5%81/"/>
    
    
  </entry>
  
  <entry>
    <title>fetchä¸­çš„Timeout</title>
    <link href="http://yoursite.com/2016/07/10/2016-07-10-fetch-timeout/"/>
    <id>http://yoursite.com/2016/07/10/2016-07-10-fetch-timeout/</id>
    <published>2016-07-09T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>éšç€ES6çš„æ™®åŠ,fetchå·²ç»æ¸æ¸å–ä»£äº†æ™®é€šajaxåœ¨å¼‚æ­¥è¯·æ±‚ä¸­çš„ä½ç½®,ä»¥å‰åœ¨ç”¨jQueryä¸­çš„ajaxæ—¶,å¯ä»¥æŒ‡å®šä¸€ä¸ªtimeoutå±æ€§,è®¾ç½®è¯¥è¯·æ±‚çš„è¶…æ—¶æ—¶é—´,ä½†æ˜¯åŸç”Ÿçš„fetchå¹¶ä¸æ”¯æŒè¯¥å±æ€§,å¦‚æœé‡åˆ°é‡åˆ°ä¸€ä¸ªè¯·æ±‚ä¸€ç›´peddingçŠ¶æ€,å°±åªèƒ½å¹²ç­‰ç€,ä»€ä¹ˆä¹Ÿå¹²ä¸äº†ã€‚ç”±äºfetchæœ¬èº«åœ¨è¢«åˆå§‹åŒ–åè¿”å›ä¸€ä¸ªPromiseå¯¹è±¡,æˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶å†åŒ…ä¸€å±‚Promiseæ¥å®ç°åœ¨fetchè¯·æ±‚ä¸­åŠ å…¥timeoutçš„åŠŸèƒ½ã€‚</p>
<p>å…ˆæ¥çœ‹ä¸‹fetchçš„åŸºæœ¬ç”¨æ³•:</p>
<pre><code>fetch(&quot;some url&quot;, {
    &quot;method&quot;: &quot;POST&quot;,
    &quot;body&quot;: JSON.stringify({
        &quot;key&quot;: &quot;value&quot;,
        &quot;arr&quot;: [1,2,3]
    }),
    ...
})
//  parse response to JSON object
.then((res) =&gt; res.json())
.then((res) =&gt; {
    //   success dome something
})
.catch((ex) =&gt; {
    //  exception occurded
});
</code></pre><p>åœ¨Promiseä¸­æœ‰ä¸ªé™æ€æ–¹æ³•,å«<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/race" target="_blank" rel="external">Promise.race()</a>,è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°,æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªPromiseçš„å®ä¾‹,å¤§è‡´ç”¨æ³•å¦‚ä¸‹:</p>
<pre><code>let promise1 = new Promise((resoleve, reject) =&gt; {
    //  do something
});

let promise2 = new Promise((resoleve, reject) =&gt; {
    //  do something
});

//  ...

let race = Promise.race([promise1, promise2, ...]);
</code></pre><p>å®ƒè¿”å›ä¸€ä¸ªPromise,è¯¥Promiseæ ¹æ®ä¼ å…¥çš„Promiseçš„ç¬¬ä¸€ä¸ªå®ŒæˆçŠ¶æ€(resolve/reject),åªè¦è¯¥Promiseå·²å®Œæˆ,å°±å°†å…¶è¿”å›ã€‚</p>
<p>çœ‹ä¸ªä¸‹é¢çš„ä¾‹å­:</p>
<pre><code>const promise1 = new Promise((resolve, reject) =&gt; {
    //  1såæ‰§è¡Œreject
    setTimeout(() =&gt; {
        reject(&quot;reject&quot;);
    }, 1000);
});

const promise2 = new Promise((resolve, reject) =&gt; {
    //  2såæ‰§è¡Œresolve
    setTimeout(() =&gt; {
        resolve(&quot;success&quot;);
    }, 2000);
});

const racedPromise = Promise.race([promise1, promise2]);

racedPromise()
.then(() =&gt; {
    alert(&quot;success&quot;);
})
.catch(() =&gt; {
    alert(&quot;fail&quot;);
});
</code></pre><p>//  æ˜¾ç„¶ä¸Šé¢çš„ä»£ç æœ€ç»ˆä¼šå¼¹å‡ºfail,å› ä¸ºpromise1çš„çŠ¶æ€æ¯”promise2å…ˆç¡®å®š,æ‰€ä»¥Promise.raceæœ€ç»ˆè¿”å›çš„æ˜¯Promise1,ç”±äºçŠ¶æ€æ˜¯reject,æ‰€ä»¥èµ°åˆ°äº†catchå›è°ƒã€‚</p>
<p>ä¸Šé¢è¯´äº†å¥½å¤šåºŸè¯:</p>
<p>ä¸‹é¢å®ç°ä¸€ä¸ªå¯è®¾ç½®timeoutçš„fetch:</p>
<pre><code>/**
  * @param url      è¯·æ±‚åœ°å€
  * @param opt      é…ç½®å‚æ•°
  * @param timeout  
  **/
function abortFetch(url, opt, timeout) {
    if(typeof url !== &quot;string&quot;) {
    }
    const fetchIns = fetch(url, opt || {});
    const abortIns = new Promise((resolve, reject) =&gt; {
        if(typeof timeout === &quot;number&quot; &amp;&amp; timeout &gt; 0) {
            setTimeout(() =&gt; {
                reject({
                    &quot;type&quot;: &quot;abord&quot;
                });
            }, timeout);
        }
    });
    const finalPromise = Promise.race([fetchIns, abortIns]);
    return finalPromise;
}

//  ç”¨æ³•

fetch(&quot;/fetch-timeout&quot;, {
    &quot;method&quot;: &quot;POST&quot;
})
.then((res) =&gt; res.json())
.then((res) =&gt; {
    if(res.status &gt;= 200 &amp;&amp; res.status &lt; 300 || res.status === 302) {
        //  do something response success
    } else {
        //  do something response failed
    }
})
.catch((ex) =&gt; {
    switch (ex.type) {
        case &quot;abord&quot;: 
            //  do something when request abord
        break;

            ...

        default:
            //  ...
        break;
    }
});
</code></pre><p>åˆ°è¿™é‡Œ,å°±åˆ©ç”¨Promise.raceå®ç°äº†ä¸€ä¸ªå¯é…ç½®è¶…æ—¶æ—¶é—´çš„fetch</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;éšç€ES6çš„æ™®åŠ,fetchå·²ç»æ¸æ¸å–ä»£äº†æ™®é€šajaxåœ¨å¼‚æ­¥è¯·æ±‚ä¸­çš„ä½ç½®,ä»¥å‰åœ¨ç”¨jQueryä¸­çš„ajaxæ—¶,å¯ä»¥æŒ‡å®šä¸€ä¸ªtimeoutå±æ€§,è®¾ç½®è¯¥è¯·æ±‚çš„è¶…æ—¶æ—¶é—´,ä½†æ˜¯åŸç”Ÿçš„fetchå¹¶ä¸æ”¯æŒè¯¥å±æ€§,å¦‚æœé‡åˆ°é‡åˆ°ä¸€ä¸ªè¯·æ±‚ä¸€ç›´peddingçŠ¶æ€,å°±åªèƒ½å¹²ç­‰ç€,ä»€ä¹ˆä¹Ÿå¹²ä¸äº†ã€‚ç”±
    
    </summary>
    
      <category term="ES6" scheme="http://yoursite.com/categories/ES6/"/>
    
      <category term="fetch" scheme="http://yoursite.com/categories/ES6/fetch/"/>
    
    
  </entry>
  
  <entry>
    <title>å®ç°ä¸€ä¸ªè¿·ä½ MVVM</title>
    <link href="http://yoursite.com/2016/06/23/2016-06-23-mvvm-tourial/"/>
    <id>http://yoursite.com/2016/06/23/2016-06-23-mvvm-tourial/</id>
    <published>2016-06-22T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨è¿‘å‡ å¹´,MVVMæ¨¡å¼ä¸€ç›´å¾ˆç«çƒ­,å…¶å…¨ç§°ä¸ºâ€Model-View-ViewModelâ€,MVVMç«çš„ä¸»è¦åŸå› å°±æ˜¯åœ¨ç”¨è¿™ç§æ¨¡å¼å¼€å‘çš„,æ›´å¤šçš„åªéœ€è¦å…³æ³¨æ•°æ®å±‚çš„ä¸œè¥¿,ä¸éœ€è¦èŠ±é¢å¤–çš„æ—¶é—´å»ç»´æŠ¤è§†å›¾,åŒ…æ‹¬angular/Vueéƒ½æ˜¯è¿™ç§å¼€å‘æ¨¡å¼,ä½†æ˜¯ä¸¤è€…çš„åŸç†æ˜¯æˆªç„¶ä¸åŒçš„,ç°åœ¨å‚è€ƒVueçš„å®ç°åŸç†,ç®€å•å®ç°ä¸€ä¸ªMVVMæ¡†æ¶,æ”¯æŒçš„æŒ‡ä»¤æœ‰â€vm-modleâ€ã€â€vm-clickâ€ã€â€vm-bindâ€,ä»£ç é‡å¤§æ¦‚åœ¨300è¡Œå·¦å³,å…ˆæ¥çœ‹ä¸‹ç”¨æ³•:</p>
<pre><code>//  HTML
...

        &lt;div id=&quot;app&quot;&gt;
            &lt;input type=&quot;text&quot; class=&quot;text-filed&quot; vm-model=&quot;text&quot; /&gt;
            &lt;p class=&quot;bind-text&quot; vm-bind=&quot;text&quot;&gt;&lt;/p&gt;
            &lt;div class=&quot;click-area&quot; vm-click=&quot;clicked()&quot;&gt;ç‚¹æˆ‘&lt;/div&gt;
            &lt;div class=&quot;click-area&quot; vm-click=&quot;clickWitharguments(text)&quot;&gt;ç‚¹æˆ‘(å¸¦å‚æ•°)&lt;/div&gt;
        &lt;/div&gt;

...

//  javascript

window.onload = function() {

    var clickTimes = 0, e;

    //  è°ƒç”¨MVVM
    MVVM({
        el: document.querySelector(&quot;#app&quot;),
        data: {
            text: &quot;I&apos;m an attribute named &apos;text&apos; under data&quot;
        },
        methods: {
            clicked: function () {
                e = event;
                clickTimes ++;
                e.target.innerHTML += &quot;&lt;p&gt;ç¬¬&quot; + clickTimes  + &quot;æ¬¡ç‚¹å‡» - &quot; + Date.now() + &quot;&lt;/p&gt;&quot;;
            },
            clickWitharguments: function (text) {
                e = event;
                e.target.innerHTML += &quot;&lt;p&gt;æ­¤æ—¶data.text = &quot; + text + &quot;&lt;/p&gt;&quot;;
            }
        }
    });
};
</code></pre><p>ä¸Šé¢å°±æ˜¯ä¸€ä¸ªç®€å•çš„è°ƒç”¨äº†,ä¸‹é¢æˆ‘ä»¬å…ˆå®ç°å‡ ä¸ªå·¥å…·æ–¹æ³•å’Œå®šä¹‰ä¸€äº›åŸºæœ¬å˜é‡:</p>
<pre><code>//  MVVM.js

//  ç”¨åŒ¿åå‡½æ•°è‡ªæ‰§è¡Œçš„æ–¹å¼,å‰é¢åŠ åˆ†å·çš„åŸå› æ˜¯ä¸ºäº†é˜²æ­¢å‹ç¼©åçš„ä¿å­˜
;(function(root) {

    //  ...


        //  åŒ¹é…æŒ‡ä»¤å¼€å¤´(&quot;vm-click&quot;,&quot;vm-model&quot;ç­‰)
    var direcivePrefix = /^vm\-/,

        //  ç¼“å­˜document
        doc = document,

        //  ç¼“å­˜document.body
        body = doc.body,

        //  æŒ‡ä»¤Mapå¯¹è±¡,ç”¨äºåˆ†ç±»å­˜å‚¨æ¯ä¸ªè¡¨è¾¾å¼,æ–¹ä¾¿åæœŸæ›´æ–°è§†å›¾
        dirsMap = {},

        //  ç¼“å­˜Array.prototype
        arr2 = [],

        //  ç¼“å­˜Object.prototype
        obj2 = {};


    /**
     * è·å–å¯¹è±¡ä¸Šçš„ç±»å
     * @param obj
     * @return {String}
     */
    function typeOf(obj) {
        return obj2.toString.call(obj).slice(8, -1);
    }

   /**
    * æŠŠå…ƒç´ ä¸Šç»‘å®šçš„æŒ‡ä»¤è½¬æ¢æˆæ•°ç»„è¿”å›
    * @param el
    * @return {Array.&lt;Object&gt;}
    */
    function mapAttributeToArray(el) {
        var res = [],
            attributes, i, len;
        if (el &amp;&amp; el.nodeType === 1) {
            attributes = arr2.slice.call(el.attributes);
            attributes.forEach(function (attr) {
                if (direcivePrefix.test(attr.name)) {
                    res.push({
                        name: attr.name,
                        value: attr.value,
                        el: el
                    });
                }
            });
        }
        return res;
    }

    /**
     * è½¬æ¢æˆé©¼å³°å†™æ³•(vm-bind -&gt; VMBind)
     * @param str
     */
    function toCamelCase(str) {
        if (str.length) {
            return str.split(&quot;-&quot;).map(function (str, index) {
                if(index &gt; 0) {
                    return str.slice(0,1).toUpperCase() + str.slice(1);
                }
                return str.toUpperCase();
            }).join(&quot;&quot;);
        }
        return &quot;&quot;;
    }


    /**
     * é€’å½’æ‰«æèŠ‚ç‚¹
     * @param rootEl        æ ¹èŠ‚ç‚¹
     * @param callback      æ‰«æåçš„å›è°ƒ
     */
    function scanNode(rootEl, callback) {
        var child = arr2.slice.call(rootEl.childNodes),
            deepChild;
        if(child.length) {
            child.forEach(function (el) {
                if(el.nodeType === 1 &amp;&amp; !el.vmcomplied) {
                    callback(el);
                    scanNode(el, callback);
                }
            });
        }
    }

    /**
     * ES5(Object.defineProperty)
     * @param target
     * @param key
     */
    function defineProperty(target, key) {
        //  åŒæ—¶è®¾ç½®ä¸€ä¸ª&quot;_&quot; + keyçš„å±æ€§å€¼,åé¢å–å€¼ç›´æ¥ç”¨
        target[&quot;_&quot; + key] = target[key];
        Object.defineProperty(target, key, {
            get: function() {
                return this[&quot;_&quot; + key];
            },
            set: function(newV) {
                //  ç”¨ä¹‹å‰è®¾ç½®çš„&quot;_&quot; + keyçš„å€¼æ¥æ¯”è¾ƒ
                if(newV !== this[&quot;_&quot; + key]) {
                    this[&quot;_&quot; + key] = newV;
                    this[key] = newV;

                    //  å–å¾—å½“å‰å±æ€§ç»‘å®šçš„æŒ‡ä»¤å¹¶ä¸”åˆ¤æ–­,æ›´æ–°è§†å›¾
                    if(typeOf(dirsMap[key]) === &quot;Array&quot; &amp;&amp; dirsMap[key].length) {
                        dirsMap[key].forEach(function(dir) {
                            dir.update();
                        });
                    }
                }
            }
        });
        return target;
    }

    //  ...


})(window)
</code></pre><p>ä¸Šé¢å®ç°äº†ä¸€äº›å·¥å…·æ–¹æ³•,å®Œæˆçš„åŠŸèƒ½ä¸»è¦æœ‰æ‰«æå­èŠ‚ç‚¹,æŠŠå…ƒç´ ä¸Šç»‘å®š çš„å±æ€§ç»‘å®šçš„æŒ‡ä»¤å–å‡ºæ¥å˜æˆä¸€ä¸ªæ•°ç»„,è½¬é©¼å³°ç­‰ç­‰,ä¸‹é¢å°±æ˜¯MVVMçš„å…¥å£äº†:</p>
<pre><code>//  MVVM.js

//  ...

/**
 * MVVMæ„é€ å‡½æ•°
 * @param opt
 * @return {MVVM.init}
 * @constructor
 */
function MVVM(opt) {
    //  æ¨¡ä»¿jQueryä¸­çš„æ— &quot;new&quot;æ“ä½œç¬¦
    return new MVVM.fn.init(opt);
}

MVVM.fn = MVVM.prototype = {

    //  ä¿®æ­£åŸå‹ä¸‹çš„æ„é€ å™¨
    constructor: MVVM,

    /**
     * MVVMå…¥å£
     * @param opt
     */
    init: function (opt) {
        //    å‚æ•°æ ¡éªŒ,è½¬æ¢
        this.el = (opt.el &amp;&amp; opt.el.nodeType === 1) ? opt.el : body;
        this.data = (typeOf(opt.data) === &quot;Object&quot;) ? opt.data : {};
        this.methods = (typeOf(opt.methods) === &quot;Object&quot;) ? opt.methods : {};
        this.scan();
    },

    /**
     * æ‰«æç¼–è¯‘
     */
    scan: function () {

        //  ä»æ ¹èŠ‚ç‚¹å¼€å§‹æ‰«æ
        scanNode(this.el, function (currentEl) {

            //  å–å¾—å½“å‰å…ƒç´ ä¸Šçš„æŒ‡ä»¤æ•°ç»„
            var dirList = mapAttributeToArray(currentEl);
            if(dirList.length) {

                //  å¾ªç¯ç¼–è¯‘æŒ‡ä»¤
                dirList.forEach(function (dir) {
                    dir.dirName = toCamelCase(dir.name);
                    if(directiveMap[dir.dirName]) {

                        //  å®ä¾‹åŒ–æŒ‡ä»¤
                        dir.dirIns = new directiveMap[dir.dirName](currentEl, dir.value, this.data, this.methods);

                        //  ç»™å½“å‰å±æ€§æŒ‡å®šgetter/setter
                        if(this.data[dir.value]) {
                            defineProperty(this.data, dir.value);
                           }

                        //  dirsMap[dir.value]ç±»å‹åˆ¤æ–­
                        if(typeOf(dirsMap[dir.value]) !== &quot;Array&quot;) {
                            dirsMap[dir.value] = [];
                        }

                        //  vm-modleä¹‹ç±»ä¸éœ€è¦æ›´æ–°è§†å›¾
                        if(dir.name !== &quot;vm-model&quot;) {
                            dirsMap[dir.value].push(dir.dirIns);
                        }
                    } else {
                        //  æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æŒ‡ä»¤æ„é€ å‡½æ•°
                        throw new Error(&quot;unsupported directive&quot; + dir.name + &quot;!&quot;);
                    }
                }, this);
            }
        }.bind(this));
    }

};

//  ä¿®æ”¹MVVM.fn.initçš„prototype
MVVM.fn.init.prototype = MVVM.fn;

//  æŒ‚è½½åˆ°å…¨å±€å¯¹è±¡
root.MVVM = MVVM;

//  ...
</code></pre><p>ä¸Šé¢å°±æ˜¯MVVM.jsçš„å…¨éƒ¨å†…å®¹äº†,MVVMçš„å…¥å£ç®—æ˜¯å®Œæˆäº†,ä¸‹é¢æˆ‘ä»¬ä¸€èµ·æ„é€ ä¹‹å‰æåˆ°çš„æŒ‡ä»¤:</p>
<pre><code>//  directive.js

;(function (root) {

        //  åŒ¹é…æŒ‡ä»¤å€¼ä¸­çš„&quot;clicked()&quot;åé¢çš„&quot;()&quot;
    var bracketsReg = /\(\)/,

        //  åŒ¹é…æŒ‡ä»¤å€¼ä¸­çš„&quot;clickWitharguments(text)&quot;åé¢çš„&quot;(text)&quot;
        bracketsArguReg = /\([\s\S]+\)/;

    /**
     * vm-bindæŒ‡ä»¤
     * @param el
     * @param expr
     * @param data
     * @param methods
     * @constructor
     */
    function VMBind(el, expr, data, methods) {
        this.el = el;
        this.expr = expr;
        this.data = data;
        this.methods = methods;
        this.init();
    }

    VMBind.prototype = {

        constructor: VMBind,

        /**
         * åˆå§‹åŒ–æ–¹æ³•
         */
        init: function () {
            this.el.textContent = this.data[&quot;_&quot; + this.expr];
        },

        /**
         * æ›´æ–°è§†å›¾
         */
        update: function () {
            this.init();
        }

    };

    /**
     * vm-modelæŒ‡ä»¤
     * @param el
     * @param expr
     * @param data
     * @param methods
     * @constructor
     */
    function VMModel(el, expr, data, methods) {
        this.oldVal = &quot;&quot;;
        this.el = el;
        this.expr = expr;
        this.data = data;
        this.methods = methods;
        this.init();
    }

    VMModel.prototype = {

        constructor: VMModel,

        /**
         * åˆå§‹åŒ–æ–¹æ³•
         */
        init: function () {
            var currentVal;
            this.oldVal = this.data[this.expr];
            this.el.value = this.oldVal;

            //  inputå…ƒç´ çš„æ ¡éªŒ
            if (this.el.tagName.toLowerCase() === &quot;input&quot;) {
                this.el.addEventListener(&quot;keyup&quot;, function () {
                    currentVal = this.el.value;

                    //  è¾“å…¥å€¼è¾ƒä¹‹å‰æœ‰å˜åŒ–
                    if (currentVal !== this.oldVal) {
                        this.update(currentVal);
                        this.oldVal = currentVal;
                    }
                }.bind(this), false);
            }
        },

        /**
         * æ›´æ–°modelä¸­çš„ç›¸å…³å±æ€§å€¼,è§¦å‘å…¶ä»–æŒ‡ä»¤å®ä¾‹ä¸‹çš„updateæ–¹æ³•
         */
        update: function (newV) {
            this.data[this.expr] = newV;
        }

    };

    /**
     * vm-clickæŒ‡ä»¤
     * @param el
     * @param expr
     * @param data
     * @param methods
     * @constructor
     */
    function VMClick(el, expr, data, methods) {
        this.el = el;
        this.expr = expr;
        this.data = data;
        this.methods = methods;
        this.init();
    }

    VMClick.prototype = {
        constructor: VMClick,

        /**
         * åˆå§‹åŒ–æ–¹æ³•
         */
        init: function () {
            //  å–å¾—æ–¹æ³•ç›¸å¯¹äºmethodsä¸­çš„æŒ‡é’ˆ
            var callback = this.methods[this.expr.replace(bracketsReg, &quot;&quot;).replace(bracketsArguReg, &quot;&quot;)],
                data = this.data,
                tmp = &quot;&quot;,
                args = [];

            //  ç±»å‹æ ¡éªŒ
            if (typeof callback === &quot;function&quot;) {
                this.el.addEventListener(&quot;click&quot;, function (e) {
                    //  å‚æ•°å¤„ç†,å½“å‰æŒ‡ä»¤å¯¹åº”çš„å€¼æ˜¯&quot;abc(de)&quot;è€Œä¸æ˜¯&quot;abc&quot;çš„å½¢å¼
                    if(!bracketsReg.test(this.expr) &amp;&amp; bracketsArguReg.test(this.expr)) {
                        tmp = this.expr.match(bracketsArguReg)[0].replace(&quot;)&quot;, &quot;&quot;).replace(&quot;(&quot;, &quot;&quot;).split(&quot;,&quot;);

                        //  ä¾æ¬¡å–å¾—ç›¸å…³å‚æ•°
                        args = tmp.map(function (name) {
                            return data[&quot;_&quot; + name.trim()];
                        });
                    }

                    //  æ‰§è¡Œç›¸å…³æ–¹æ³•
                    callback.apply(root, args);
                }.bind(this), false);
            }
        }
    };

    //  æŒ‚è½½åˆ°windowå¯¹è±¡ä¸‹
    root.directiveMap = {
        VMBind: VMBind,
        VMModel: VMModel,
        VMClick: VMClick,
    };

})(window)
</code></pre><p>å¥½äº†,åˆ°è¿™é‡Œæˆ‘ä»¬çš„MVVMå…¥å£å’ŒæŒ‡ä»¤éƒ½å…¨éƒ¨å®ç°å¥½äº†,ä¸‹é¢ä¸€èµ·çœ‹ä¸‹æ•ˆæœå§:</p>
<p><img src="/imgs/mvvm-run.gif" alt="è¿è¡Œæ•ˆæœ"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨è¿‘å‡ å¹´,MVVMæ¨¡å¼ä¸€ç›´å¾ˆç«çƒ­,å…¶å…¨ç§°ä¸ºâ€Model-View-ViewModelâ€,MVVMç«çš„ä¸»è¦åŸå› å°±æ˜¯åœ¨ç”¨è¿™ç§æ¨¡å¼å¼€å‘çš„,æ›´å¤šçš„åªéœ€è¦å…³æ³¨æ•°æ®å±‚çš„ä¸œè¥¿,ä¸éœ€è¦èŠ±é¢å¤–çš„æ—¶é—´å»ç»´æŠ¤è§†å›¾,åŒ…æ‹¬angular/Vueéƒ½æ˜¯è¿™ç§å¼€å‘æ¨¡å¼,ä½†æ˜¯ä¸¤è€…çš„åŸç†æ˜¯æˆªç„¶ä¸åŒçš„,ç°åœ¨å‚è€ƒV
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="MVVM" scheme="http://yoursite.com/categories/javascript/MVVM/"/>
    
    
  </entry>
  
  <entry>
    <title>ES6ä¸­çš„Promise</title>
    <link href="http://yoursite.com/2016/05/04/2016-05-04-es6-promise/"/>
    <id>http://yoursite.com/2016/05/04/2016-05-04-es6-promise/</id>
    <published>2016-05-03T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨æ‰§è¡Œä¸€äº›å¼‚æ­¥æ“ä½œ(å…¸å‹çš„æœ‰JavaScriptä¸­çš„ajax/NodeJsä¸­è¯»å–æ–‡ä»¶ç­‰ç­‰)çš„æ—¶å€™,æˆ‘ä»¬ä¸çŸ¥é“è¯¥æ“ä½œä»€ä¹ˆæ—¶å€™å®Œæˆ,æ‰€ä»¥å°±éœ€è¦åœ¨ä¸åŒçš„æ—¶å€™å†™ä¸Šå›è°ƒ,ç­‰åˆ°æœ‰è¿”å›çš„æ—¶å€™,å†æ‰§è¡Œä¸‹ä¸€æ­¥æ“ä½œ,ä¸‹é¢å°±ç”¨jQueryä¸­çš„ä¸€ä¸ªajaxæ¥åšç¤ºä¾‹:</p>
<pre><code>$.ajax({
    &quot;url&quot;: &quot;xxx&quot;,
    &quot;type&quot;: &quot;GET&quot;,
    &quot;dataType&quot;: &quot;&quot;JSON,
    &quot;success&quot;: function(res){},
    &quot;error&quot;: function(ex){
        //  do some thing
    }
});
</code></pre><p>æœ€åŸºç¡€çš„ä¸€ä¸ªajaxç¤ºä¾‹,å½“æˆ‘ä»¬æœ‰å¤šä¸ªajaxåµŒå¥—è¯·æ±‚çš„æ—¶å€™,å°±ä¸­äº†æ‰€è°“çš„â€å›è°ƒåœ°ç‹±â€,ç±»ä¼¼äºä¸‹é¢çš„å†™æ³•:</p>
<pre><code>$.ajax({
    //  some configs
    &quot;success&quot;: function(res){
        $.ajax({
            //  ...
            &quot;success&quot;: function(res){
                $.ajax({
                    //  ...
                    &quot;success&quot;:function(res){
                        .
                        .
                        .
                    }
                });
            }
        });
    }
});
</code></pre><p>ä¸€å±‚å¥—ç€ä¸€å±‚,ä»£ç å¯è¯»æ€§å¾ˆå·®,ä¸”ä¸å®¹æ˜“åæœŸçš„ç»´æŠ¤</p>
<p>è¿™æ—¶å€™å°±éœ€è¦ä¸€ä¸ªæ¯”å‰è€…å¥½çš„è§£å†³æ–¹æ¡ˆæ¥è§£å†³è¯¥é—®é¢˜,ES6ä¸­çš„Promiseä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†è¯¥é—®é¢˜:</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Promiseå¯¹ajaxè¿›è¡Œä¸€å±‚å°è£…</p>
<pre><code>function _ajax(url, method, args) {
    let promise = new Promise((resolve, reject) =&gt; {

        let client = new XMLHttpRequest();
        let uri = url;

        if (args &amp;&amp; (method == &quot;POST&quot; || method == &quot;PUT&quot;)) {
            let argcount = 0;
            uri += &quot;?&quot;;
            for (var key in args) {
                if (args.hasOwnProperty(key)) {
                    if (argcount++) {
                        uri += &apos;&amp;&apos;;
                    }
                    uri += encodeURIComponent(key) + &apos;=&apos; + encodeURIComponent(args[key]);
                }
            }
        }

        client.open(method, uri);
        client.send();

        client.onload = function() {
            if (this.status &gt;= 200 &amp;&amp; this.status &lt; 300) {
                resolve(this.response);
            } else {
                reject(this.statusText);
            }
        };
        client.onerror = function() {
            reject(this.statusText);
        };

    });

    return promise;
}

let core = {

    &quot;GET&quot;: function(args) {
        return _ajax(url, &quot;GET&quot;, args);
    },

    &quot;POST&quot;: function(args) {
        return _ajax(url, &quot;POST&quot;, args);
    },

    &quot;PUT&quot;: function(args) {
        return _ajax(url, &quot;PUT&quot;, args);
    },

    &quot;DELETE&quot;: function(args) {
        return _ajax(url, &quot;DELETE&quot;, args);
    }

};
</code></pre><p>ä¸Šé¢è¿™æ®µä»£ç æ˜¯JavaScript MDNä¸Šçš„ä»£ç (å¯èƒ½ç¨å¾®æœ‰ç‚¹æ”¹åŠ¨),å®ƒå¯¹ajaxè¿›è¡Œäº†ä¸€å±‚å°è£…,ç»è¿‡è¿™å±‚å°è£…,æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·å†™ä¸€äº›å¼‚æ­¥ä»£ç :</p>
<pre><code>$http(&quot;xxx&quot;)
.GET()
.then((data) =&gt; {

    //  do something

    $http(&quot;xxx2&quot;)
    .GET()
    .then((data) =&gt; {

        //  do something

        $http(&quot;xxx3&quot;)
        .GET({&quot;key&quot;,&quot;value&quot;})
        .then((data) =&gt; {
            //  do something...
        })


    },(ex) =&gt; {});

})
.catch((ex) =&gt; {});
</code></pre><p>è™½ç„¶è¿˜æœ‰åµŒå¥—,ä½†æ˜¯ä»£ç çœ‹èµ·æ¥å·²ç»èˆ’æœäº†å¾ˆå¤šã€‚</p>
<p>Promiseæ˜¯ä¸€ä¸ªå¼‚æ­¥ç¼–ç¨‹çš„æŠ½è±¡,å®ƒæ˜¯ä¸€ä¸ªè¿”å›å€¼æˆ–æŠ›å‡ºexceptionçš„ä»£ç†å¯¹è±¡,ä¸€èˆ¬promiseå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªthenæ–¹æ³•,è¿™ä¸ªthenæ–¹æ³•æ˜¯æˆ‘ä»¬å¦‚ä½•è·å¾—è¿”å›å€¼(æˆåŠŸå®ç°æ‰¿è¯ºçš„ç»“æœå€¼,ç§°ä¸ºfulfillment)æˆ–æŠ›å‡ºexception(æ‹’ç»æ‰¿è¯ºçš„ç†ç”±,ç§°ä¸ºrejection)ï¼Œthenæ˜¯ç”¨ä¸¤ä¸ªå¯é€‰çš„å›è°ƒä½œä¸ºå‚æ•°,æˆ‘ä»¬å¯ä»¥ç§°ä¸ºonFulfilledå’ŒOnRejected,ä¹Ÿå¯ä»¥æŠŠOnRejectedå†™åœ¨catché‡Œé¢</p>
<p>æ‰€ä»¥ä¸€ä¸ªPromiseä¸€å…±æœ‰ä¸‹é¢å‡ ä¸ªçŠ¶æ€</p>
<ol>
<li>pendingå¾…æ‰¿è¯º - promiseåˆå§‹çŠ¶æ€</li>
<li>fulfilledå®ç°æ‰¿è¯º - ä¸€ä¸ªæ‰¿è¯ºæˆåŠŸå®ç°çŠ¶æ€</li>
<li>rejectedæ‹’ç»æ‰¿è¯º - ä¸€ä¸ªæ‰¿è¯ºå¤±è´¥çš„çŠ¶æ€</li>
</ol>
<p>å†æ¥ä¸ªNodeJsä¸­è¯»å–æ–‡ä»¶çš„ä¾‹å­:</p>
<pre><code>function readFile(path) {
    var fs = require(&quot;fs&quot;);
    var prromise = new Promise((resolve, reject) =&gt; {
        fs.readdir(path, (ex, files) =&gt; {
            if (ex) {
                return reject(ex);
            }
            return resolve(files);
        });
    });

    return prromise;
}

readFile(config.avatarPath + &quot;1&quot;).then((files) =&gt; {
    //  do some thing
    console.log(files);
}).catch((ex) =&gt; {
    //  do something...
    console.log(ex);
});
</code></pre><p>å¦‚æœä¸ç”¨Promiseå’Œä¸€äº›ES6çš„ç‰¹æ€§,ä¸Šé¢çš„ä»£ç åº”è¯¥çœ‹èµ·æ¥æ˜¯ä¸‹é¢çš„è¿™æ ·å­:</p>
<pre><code>var fs = require(&quot;fs&quot;);
fs.readdir(path, function (ex, files) {
    if (ex) {
        //  do something
        return console.log();
    }

    //  do some thing
    console.log(files);
});
</code></pre><p>ä»£ç é‡å¯èƒ½æ›´å°‘,ä½†æ˜¯é™·å…¥â€å›è°ƒåœ°ç‹±â€çš„å¯èƒ½å°±æ›´å¤§äº†,åœ¨ES7ä¸­,åˆæ–°å¢äº†async/awaitç‰¹æ€§æ¥é’ˆå¯¹å¼‚æ­¥æ“ä½œçš„,åé¢ä»‹ç»ğŸ˜„</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨æ‰§è¡Œä¸€äº›å¼‚æ­¥æ“ä½œ(å…¸å‹çš„æœ‰JavaScriptä¸­çš„ajax/NodeJsä¸­è¯»å–æ–‡ä»¶ç­‰ç­‰)çš„æ—¶å€™,æˆ‘ä»¬ä¸çŸ¥é“è¯¥æ“ä½œä»€ä¹ˆæ—¶å€™å®Œæˆ,æ‰€ä»¥å°±éœ€è¦åœ¨ä¸åŒçš„æ—¶å€™å†™ä¸Šå›è°ƒ,ç­‰åˆ°æœ‰è¿”å›çš„æ—¶å€™,å†æ‰§è¡Œä¸‹ä¸€æ­¥æ“ä½œ,ä¸‹é¢å°±ç”¨jQueryä¸­çš„ä¸€ä¸ªajaxæ¥åšç¤ºä¾‹:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
    
    </summary>
    
      <category term="ES6" scheme="http://yoursite.com/categories/ES6/"/>
    
      <category term="Promise" scheme="http://yoursite.com/categories/ES6/Promise/"/>
    
    
  </entry>
  
  <entry>
    <title>å®ç°æ¨¡å—åŒ–ç¼–ç¨‹</title>
    <link href="http://yoursite.com/2016/03/24/2016-03-24-javascript-self-loader/"/>
    <id>http://yoursite.com/2016/03/24/2016-03-24-javascript-self-loader/</id>
    <published>2016-03-23T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…ˆä¸Šä¸ªå°ä¾‹å­(å·¥èµ„è®¡ç®—å™¨):</p>
<ul>
<li>ä¼ ç»Ÿ</li>
</ul>
<pre><code>//  ç»©æ•ˆå¥–é‡‘
function performanceCoefficient(salary) {
    return salary * 0.2;
}

//  ä½æˆ¿å…¬ç§¯é‡‘
function companyReserve(salary) {
    return salary * 0.2;
}

//  ä¸ªäººæ‰€å¾—ç¨ã€äº”é™©ä¸€é‡‘
function incomeTax(remain) {
    return (remain - 3500) * 0.2;
}

//  åŸºæœ¬å·¥èµ„
var salary = 10000;

//  æœ€åç¨å‰å·¥èµ„
var finalSalary = salary + performanceCoefficient(salary);

finalSalary = finalSalary - incomeTax(finalSalary - companyReserve(finalSalary));

console.log(finalSalary);
</code></pre><ul>
<li><p>ç±»æ¨¡å—åŒ–</p>
<pre><code>//  å…¨å±€å˜é‡,å­˜å‚¨å·²ç»å£°æ˜çš„æ¨¡å—
var modules = {};

//  å…ˆæ¥å®ç°å‡ ä¸ªå·¥å…·å‡½æ•°
var define = (function() {

//  æ ¹æ®depArrsä¸­çš„æ¨¡å—åç§°æ‰¾å‡ºmodulesä¸­çš„ç›¸å…³å¯¹è±¡
var _require = function(depArrs) {
    return depArrs.map(function(dep) {
        return modules[dep];
    });
};

    //  defineå‡½æ•°å®é™…åšçš„äº‹æƒ…
    return function(id, depArrs, factory) {

        //  åˆ¤æ–­æ˜¯å¦å·²ç»å£°æ˜è¿‡åŒåæ¨¡å—
        deps.map(function(dep) {
            return dep.factory.apply(window, dep.deps);
        });

        var deps = _require(depArrs);
        if (modules[id]) {
            throw new Error(&quot;module &quot; + id + &quot; has been declared!&quot;);
        }
        modules[id] = {
            id: id,
            factory: factory,
            deps: deps
        };
    };
})();

//  å®ç°ä¸€ä¸ªè°ƒç”¨ä¸»å…¥å£æ–‡ä»¶,åªéœ€ä¼ å…¥æ¨¡å—idå³å¯
//  ç±»ä¼¼äºseaä¸­çš„sea.use(&quot;id&quot;, [], function(){ /*...*/ })
//  æˆ–è€…requirejsä¸­çš„require([&quot;id&quot;])
var loader = function(id) {
    if (!modules[id]) {
        throw new Error(&quot;module&quot; + id + &quot; has not been declared!&quot;);
    }
    var deps = modules[id].deps;
    deps = deps.map(function(dep) {
        return dep.factory.apply(window, dep.deps);
    });
    modules[id].factory.apply(window, deps);
};

//  å£°æ˜ä¸€ä¸ªè®¡ç®—æ¨¡å—
define(&quot;calc&quot;, [], function() {
    return {
        performanceCoefficient: function(salary) {
            return salary * 0.2;
        },
        companyReserve: function(salary) {
            return salary * 0.2;
        },
        incomeTax: function(remain) {
            return (remain - 3500) * 0.2;
        }
    };
});

//  æœ€ç»ˆç”¨æ¥è®¡ç®—å·¥èµ„çš„æ¨¡å—
define(&quot;salary&quot;,[&quot;calc&quot;], function(calc) {
    var slary = 10000000,
        finalSalary = slary + calc.performanceCoefficient(slary);

    finalSalary = finalSalary - calc.incomeTax(finalSalary - calc.companyReserve(finalSalary));

    console.log(finalSalary);

});

loader(&quot;salary&quot;);
</code></pre></li>
</ul>
<p>ä¸Šé¢ä¸¤æ®µä»£ç éƒ½å®Œæˆäº†ç›¸åŒçš„åŠŸèƒ½,ä½†æ˜¯åœ¨å†™æ³•ä¸Šå·®åˆ«å¾ˆå¤§,ç§°ç¬¬äºŒç§æ–¹å¼æ˜¯ç±»æ¨¡å—åŒ–çš„åŸå› æ˜¯ç°åœ¨çš„ä»£ç è¿˜æ²¡æœ‰å®Œå…¨å®ç°æ¨¡å—åŒ–,æ‰€æœ‰çš„æ¨¡å—éƒ½åœ¨åŒä¸€æ–‡ä»¶,æ²¡æœ‰å®ç°å®Œå…¨è§£è€¦,è¿™æ—¶å°±éœ€è¦åŠ è½½å™¨(require)æ¥å¸®æˆ‘ä»¬å®Œæˆå„åŠŸèƒ½æ¨¡å—åˆ†æ–‡ä»¶çš„ç›®çš„,æ¨¡å—åŒ–çš„ä¼˜åŠ¿ä¸è¨€è€Œå–»,åé¢ä»‹ç»ä¸€æ­¥æ­¥å®ç°ä¸€ä¸ªç¬¦åˆAMDè§„èŒƒçš„åŠ è½½å™¨ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…ˆä¸Šä¸ªå°ä¾‹å­(å·¥èµ„è®¡ç®—å™¨):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼ ç»Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;//  ç»©æ•ˆå¥–é‡‘
function performanceCoefficient(salary) {
    return salary * 0.2;
}

//  ä½
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="ç»§æ‰¿" scheme="http://yoursite.com/categories/javascript/%E7%BB%A7%E6%89%BF/"/>
    
    
  </entry>
  
  <entry>
    <title>javascriptå®ç°ç»§æ‰¿ä¹‹2</title>
    <link href="http://yoursite.com/2016/03/10/2016-03-10-js-object-extend2/"/>
    <id>http://yoursite.com/2016/03/10/2016-03-10-js-object-extend2/</id>
    <published>2016-03-09T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å‰é¢çš„ä¸€ç¯‡æ–‡ç« <a href="http://rwson.github.io/%E6%8A%80%E6%9C%AF/2015/05/26/js-object-extend.html" target="_blank" rel="external">JavaScriptå®ç°ç»§æ‰¿</a>ä»‹ç»è¿‡jsä¸­é€šè¿‡åŸå‹æ¥ç»§æ‰¿çš„ä¸¤ç§æ–¹æ³•</p>
<ol>
<li>ä¼ªé€ å¯¹è±¡ç»§æ‰¿:é€šè¿‡æŠŠçˆ¶ç±»çš„å®ä¾‹èµ‹å€¼ç»™å­ç±»çš„prototypeï¼Œç„¶ååœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼›</li>
<li>ç±»å¼ç»§æ‰¿(åŸå‹å¼ç»§æ‰¿):é€šè¿‡ä¸€ä¸ªç©ºå‡½æ•°ä¸­è½¬ï¼ŒæŠŠçˆ¶ç±»çš„ç¤ºä¾‹èµ‹å€¼ç»™è¯¥ç©ºå‡½æ•°çš„åŸå‹ï¼Œç„¶åå†æŠŠè¯¥ç©ºå‡½æ•°çš„prototypeèµ‹å€¼ç»™å­ç±»çš„prototypeï¼Œå†åœ¨å­ç±»çš„æ„é€ æ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ï¼Œå®ç°ç»§æ‰¿ã€‚</li>
</ol>
<p>ç»¼åˆä¸Šé¢ä¸¤ä¸ªæ–¹æ³•ï¼Œå…¶å®éƒ½é€šè¿‡ä¸¤æ¬¡è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨æ¥å®ç°ï¼Œç¬¬äºŒç§æ–¹æ³•ç›¸å¯¹äºç¬¬ä¸€ç§åªæ˜¯åœ¨å­ç±»åŸå‹ä¸Šå°‘äº†äº›çˆ¶ç±»çš„å®ä¾‹å±æ€§ã€‚</p>
<p>åœ¨ã€ŠjavaScripté«˜çº§ç¨‹åºã€‹ä¸­ï¼Œä»‹ç»äº†å¦å¤–ä¸€ç§ç»§æ‰¿çš„å®ç°æ–¹å¼ï¼Œåä¸ºâ€å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿â€ã€‚æ‰€è°“çš„å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿ï¼Œä¸å¿…ä¸ºäº†å­ç±»çš„åŸå‹è€Œè°ƒç”¨è¶…ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œè¦å®ç°ç»§æ‰¿åªéœ€è¦çˆ¶ç±»åŸå‹çš„ä¸€ä¸ªå‰¯æœ¬ã€‚ä¸‹é¢çš„å…·ä½“çš„ä»£ç :</p>
<pre><code>/**
 * å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿
 * @param subType   å­ç±»
 * @param superType çˆ¶ç±»
 **/
function inheritPrototype(subType,subperType){
    var prototype = Object(superType.prototype);
    prototype.constructor = subType;
    subType.prototype = prototype;
}

/**
 * çˆ¶ç±»
 * @param name   nameå±æ€§
 **/
function superClass(name) {
    this.name = name;
}

superClass.prototype.sayName = function() {
    alert(this.name);    
};

/**
 * å­ç±»
 * @param name   nameå±æ€§
 * @param age    ageå±æ€§
 **/
function subClass(name,age) {
    superClass.call(this,name);
    this.age = age;
}

//  å®ç°ç»§æ‰¿
inheritPrototype(subClass,superClass);
</code></pre><p>è¿™æ ·å°±åªè°ƒç”¨äº†ä¸€æ¬¡çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œåœ¨æ€§èƒ½ä¸Šæ›´ä¼˜ç§€ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨å‰é¢çš„ä¸€ç¯‡æ–‡ç« &lt;a href=&quot;http://rwson.github.io/%E6%8A%80%E6%9C%AF/2015/05/26/js-object-extend.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;JavaScriptå®ç°ç»§
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="ç»§æ‰¿" scheme="http://yoursite.com/categories/javascript/%E7%BB%A7%E6%89%BF/"/>
    
    
  </entry>
  
  <entry>
    <title>javascriptçš„é«˜é˜¶å‡½æ•°</title>
    <link href="http://yoursite.com/2016/01/16/2016-01-16-javascript-higher-order-functions/"/>
    <id>http://yoursite.com/2016/01/16/2016-01-16-javascript-higher-order-functions/</id>
    <published>2016-01-15T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>é«˜é˜¶å‡½æ•°:å¬åˆ°é«˜é˜¶æ„Ÿè§‰å¾ˆé«˜å¤§ä¸Šçš„ä¸€ä¸ªè¯,ä½†æ˜¯å®ç°èµ·æ¥å¹¶ä¸æ˜¯é‚£ä¹ˆéš¾ã€‚</p>
<p>è®°å¾—æœ‰ä¸€æ¬¡åœ¨çœ‹jsé¢è¯•é¢˜ç›¸å…³èµ„æ–™æ—¶,çœ‹åˆ°ç±»ä¼¼äºä¸‹é¢ä¸€ä¸ªé¢˜ç›®,å®ç°ä¸€ä¸ªå‡½æ•°,èƒ½æœ‰å¦‚ä¸‹å†™æ³•,å®ç°ä¸¤ä¸ªå€¼ç›¸åŠ å¹¶è¿”å›,å†™æ³•å¤§æ¦‚æ˜¯è¿™æ ·çš„:</p>
<pre><code>add(10)(5);
</code></pre><p>ä»¥å‰æ²¡è§è¿‡è¿™ç§å†™æ³•,ç›¸ä¿¡å¤§å®¶å¯¹ä¸‹é¢çš„å†™æ³•è‚¯å®šä¸é™Œç”Ÿ:</p>
<pre><code>function add(){
    return function(a,b){
        return a + b;
    };
}

//  ç„¶åè°ƒç”¨çš„æ—¶å€™å†™æˆä¸‹é¢çš„æ ·å­

add()(10,5);

//  æœ€åè¿”å›15
</code></pre><p>ä»”ç»†è§‚å¯Ÿè¿™ä¸¤ç§å†™æ³•,å‘ç°å®ƒä»¬åœ¨å†™æ³•ä¸Šå·®åˆ«å¾ˆå°,ç¬¬ä¸€ç§å†™æ³•æ˜¯ä¸€ä¸ªæ‹¬å·é‡Œæ”¾ä¸€ä¸ªå‚æ•°,è€Œç¬¬äºŒç§å†™æ³•æ˜¯æŠŠä¸¤ä¸ªå‚æ•°æ”¾åœ¨åŒä¸€ä¸ªæ‹¬å·é‡Œ,æ—¢ç„¶å†™æ³•ç±»ä¼¼,å®ç°èµ·æ¥è‚¯å®šåŒºåˆ«ä¹Ÿä¸æ˜¯ç‰¹åˆ«å¤§,ä¸”çœ‹ä¸‹é¢çš„å®ç°:</p>
<pre><code>function add(a){
    return function(b){
        return a + b;
    }
}
</code></pre><p>è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†ä¸€ä¸ªé«˜é˜¶å‡½æ•°ã€‚åœ¨ä¸Šé¢ä¸¤ä¸ªä¾‹å­ä¸­,è°ƒç”¨addå¹¶æ²¡æœ‰ç«‹å³è¿”å›ä¸€ä¸ªè®¡ç®—åçš„å€¼,è€Œæ˜¯è¿”å›äº†ä¸€ä¸ªå‡½æ•°,è°ƒç”¨è¯¥è¿”å›çš„å‡½æ•°å,æ‰ä¼šè¿”å›å…·ä½“è®¡ç®—åçš„å€¼,è¿™æ ·å°±æœ‰äº†ç¬¬äºŒå¯¹æ‹¬å·ã€‚</p>
<p>å†æ¥çœ‹ä¸ªä¾‹å­:</p>
<pre><code>function func(p1){
    var self = this;

    function fd(p2) {
        this.add1 = function (p3) {
            return p1 + &quot;,&quot; + p2 + &quot; &quot; + p3;
        };
    }

    self.add =  function (p2){
        fd.call(this, p2);
        return this.add1;
    };

    return self.add;
}

//  ä¹Ÿå¯ä»¥ç›´æ¥è¿™æ ·å®ç°
function func(p1){
    return function(p2){
        return function(p3){
            return p1 + &quot;,&quot; + p2 + &quot; &quot; + p3;
        }
    }
}
</code></pre><p>å†æ¥ä¸ªå®ä¾‹,è§£å†³æ•°ç»„å…ƒç´ ç´¯åŠ çš„é—®é¢˜:</p>
<pre><code>function addArray(arr){
    var res = 0;
    if(Array.prototype.forEach){
        arr.forEach(function(item){
            res += item;
        });
        return res;
    }
    for(var i = 0,len = arr.length;i &lt; len;i ++){
        res += arr[i];
    }
    return res;
}

function applyAdd(func,arr){
    return func.apply(func,Array.prototype.slice.call(arguments, 1));
}

console.log(applyAdd(addArray,[1,2,3,4,5,6,7,8,9]));
</code></pre><p>åœ¨è°ƒç”¨applyAddæ—¶,å…¶å®çœŸæ­£èµ°çš„æ˜¯addArrayæ–¹æ³•ã€‚</p>
<p>åœ¨è‘—åçš„jså·¥å…·åº“underscoreJsä¸­,ä¹Ÿæœ‰ç±»ä¼¼çš„ä¾‹å­,åé¢ä»‹ç»ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é«˜é˜¶å‡½æ•°:å¬åˆ°é«˜é˜¶æ„Ÿè§‰å¾ˆé«˜å¤§ä¸Šçš„ä¸€ä¸ªè¯,ä½†æ˜¯å®ç°èµ·æ¥å¹¶ä¸æ˜¯é‚£ä¹ˆéš¾ã€‚&lt;/p&gt;
&lt;p&gt;è®°å¾—æœ‰ä¸€æ¬¡åœ¨çœ‹jsé¢è¯•é¢˜ç›¸å…³èµ„æ–™æ—¶,çœ‹åˆ°ç±»ä¼¼äºä¸‹é¢ä¸€ä¸ªé¢˜ç›®,å®ç°ä¸€ä¸ªå‡½æ•°,èƒ½æœ‰å¦‚ä¸‹å†™æ³•,å®ç°ä¸¤ä¸ªå€¼ç›¸åŠ å¹¶è¿”å›,å†™æ³•å¤§æ¦‚æ˜¯è¿™æ ·çš„:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;add(10)(5);
&lt;/co
    
    </summary>
    
      <category term="javascript" scheme="http://yoursite.com/categories/javascript/"/>
    
      <category term="é«˜é˜¶å‡½æ•°" scheme="http://yoursite.com/categories/javascript/%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>React Nativeè‡ªå®šä¹‰åŸç”Ÿæ¨¡å—</title>
    <link href="http://yoursite.com/2016/01/12/2016-01-12-expend-objectc/"/>
    <id>http://yoursite.com/2016/01/12/2016-01-12-expend-objectc/</id>
    <published>2016-01-11T16:00:00.000Z</published>
    <updated>2017-03-30T12:19:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç°å¦‚ä»Šï¼Œè¶Šæ¥è¶Šå¤šçš„ç§»åŠ¨å¼€å‘è€…é€‰æ‹©ç”¨React Nativeæ¥å¼€å‘ä»–ä»¬çš„appã€‚è™½ç„¶React Nativeæä¾›äº†å¼ºå¤§çš„APIä¾›æˆ‘ä»¬è°ƒç”¨ï¼Œä½†æ˜¯å¯¹äºä¸€äº›åŠŸèƒ½(æ¯”å¦‚ç¬¬ä¸‰æ–¹æ”¯ä»˜ã€æ–‡ä»¶ä¸Šä¼ ä¹‹ç±»çš„)ï¼ŒåŸç”Ÿæ¨¡å—ä¸­å¹¶æ²¡æœ‰æä¾›ç»™æˆ‘ä»¬ç›¸å…³çš„APIï¼Œè¿™æ—¶å€™å°±éœ€è¦æˆ‘ä»¬æ¥è‡ªå·±å°è£…ä¸€äº›ä¸œè¥¿æ¥ç»™jsç«¯è°ƒç”¨ã€‚è¿™è¾¹ä»¥iosç«¯çš„ä¸ºä¾‹æ¥ä»‹ç»ã€‚</p>
<hr>
<h6 id="æ¨¡å—é…ç½®è¡¨"><a href="#æ¨¡å—é…ç½®è¡¨" class="headerlink" title="æ¨¡å—é…ç½®è¡¨"></a>æ¨¡å—é…ç½®è¡¨</h6><p>åœ¨RNåŠ è½½çš„æ—¶å€™ï¼Œæ‰€æœ‰æ³¨å†Œå¹¶ä¸”ç¬¦åˆè§„èŒƒçš„æ¨¡å—éƒ½ä¼šè¢«å¯¼å‡ºå¹¶ä¸”ç”Ÿæˆç›¸åº”çš„æ¨¡å—æ•°æ®ç±»RCTModuleDataï¼Œè€Œæ¨¡å—æ•°æ®ä¸­ç¼“å­˜äº†æ¨¡å—çš„å¯¹è±¡å®ä¾‹ï¼Œä»¥åŠæ¨¡å—ç´¢å¼•idã€‚</p>
<p>æœ€åå¤§æ¦‚ç”Ÿæˆä¸€ä¸ªå¦‚ä¸‹çš„æ¨¡å—é…ç½®è¡¨:</p>
<pre><code>{
    &quot;remoteModuleConfig&quot;: {
        &quot;className&quot;: {
            &quot;methods&quot;: {
                &quot;method&quot;: {
                    &quot;type&quot;: &quot;remote&quot;,
                    &quot;methodID&quot;: 0
                },
                ...
            },
            &quot;moduleID&quot;: 4
        },
        ...
     },
}
</code></pre><h6 id="é€šä¿¡æµç¨‹"><a href="#é€šä¿¡æµç¨‹" class="headerlink" title="é€šä¿¡æµç¨‹"></a>é€šä¿¡æµç¨‹</h6><p>å…ˆçœ‹ä¸€ä¸ªjsè°ƒç”¨OCçš„ä¸‹çš„æ–¹æ³•èµ°äº†å“ªäº›æ­¥éª¤:</p>
<p><img src="/imgs/progress.jpg" alt=""></p>
<p>1.JSç«¯è°ƒç”¨æŸä¸ªOCæ¨¡å—æš´éœ²å‡ºæ¥çš„æ–¹æ³•ã€‚</p>
<p>2.æŠŠä¸Šä¸€æ­¥çš„è°ƒç”¨åˆ†è§£ä¸ºModuleName,MethodName,argumentsï¼Œå†æ‰”ç»™MessageQueueå¤„ç†ã€‚</p>
<p>3.åœ¨è¿™ä¸€æ­¥æŠŠJSçš„callbackå‡½æ•°ç¼“å­˜åœ¨MessageQueueçš„ä¸€ä¸ªæˆå‘˜å˜é‡é‡Œï¼Œç”¨CallbackIDä»£è¡¨callbackã€‚åœ¨é€šè¿‡ä¿å­˜åœ¨MessageQueueçš„æ¨¡å—é…ç½®è¡¨æŠŠä¸Šä¸€æ­¥ä¼ è¿›æ¥çš„ModuleNameå’ŒMethodNameè½¬ä¸ºModuleIDå’ŒMethodIDã€‚</p>
<p>4.æŠŠä¸Šè¿°æ­¥éª¤å¾—åˆ°çš„ModuleID,MethodId,CallbackIDå’Œå…¶ä»–å‚æ•°argusä¼ ç»™OCã€‚è‡³äºå…·ä½“æ˜¯æ€ä¹ˆä¼ çš„ï¼Œåé¢å†è¯´ã€‚</p>
<p>5.OCæ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œé€šè¿‡æ¨¡å—é…ç½®è¡¨æ‹¿åˆ°å¯¹åº”çš„æ¨¡å—å’Œæ–¹æ³•ã€‚</p>
<p>6.RCTModuleMethodå¯¹JSä¼ è¿‡æ¥çš„æ¯ä¸€ä¸ªå‚æ•°è¿›è¡Œå¤„ç†ã€‚</p>
<p>7.OCæ¨¡å—æ–¹æ³•è°ƒç”¨å®Œï¼Œæ‰§è¡Œblockå›è°ƒã€‚</p>
<p>8.è°ƒç”¨åˆ°ç¬¬6æ­¥è¯´æ˜çš„RCTModuleMethodç”Ÿæˆçš„blockã€‚</p>
<p>9.blocké‡Œå¸¦ç€CallbackIDå’Œblockä¼ è¿‡æ¥çš„å‚æ•°å»è°ƒJSé‡ŒMessageQueueçš„æ–¹æ³•invokeCallbackAndReturnFlushedQueueã€‚</p>
<p>10.MessageQueueé€šè¿‡CallbackIDæ‰¾åˆ°ç›¸åº”çš„JS callbackæ–¹æ³•ã€‚</p>
<p>11.è°ƒç”¨callbackæ–¹æ³•ï¼Œå¹¶æŠŠOCå¸¦è¿‡æ¥çš„å‚æ•°ä¸€èµ·ä¼ è¿‡å»ï¼Œå®Œæˆå›è°ƒã€‚</p>
<p>æ•´ä¸ªæµç¨‹å°±æ˜¯è¿™æ ·ï¼Œç®€å•æ¦‚æ‹¬ä¸‹ï¼Œå·®ä¸å¤šå°±æ˜¯ï¼šJSå‡½æ•°è°ƒç”¨è½¬ModuleID/MethodID -&gt; callbackè½¬CallbackID -&gt; OCæ ¹æ®IDæ‹¿åˆ°æ–¹æ³• -&gt; å¤„ç†å‚æ•° -&gt; è°ƒç”¨OCæ–¹æ³• -&gt; å›è°ƒCallbackID -&gt; JSé€šè¿‡CallbackIDæ‹¿åˆ°callbackæ‰§è¡Œ</p>
<p>ä¸‹é¢å°±ç®€å•åˆ†äº«ä¸€ä¸ªä»OCæš´éœ²æ–¹æ³•åˆ°JSç«¯è°ƒç”¨çš„ä¾‹å­ï¼š</p>
<pre><code>// OC(RCTDeviceExtension.m)

#import &quot;RCTBridgeModule.h&quot;
#import &quot;RCTUtils.h&quot;
//  RCTScreenSizeç”¨åˆ°

@interface RCTDeviceExtension : NSObject &lt;RCTBridgeModule&gt;

@end

@implementation RCTDeviceExtension

RCT_EXPORT_MODULE();
//  æš´éœ²ä¸€ä¸ªæ¨¡å—

/**
  è·å–è®¾å¤‡çš„ç›¸å…³ä¿¡æ¯
 **/
static NSDictionary *DynamicDimesions(){
  CGFloat width = MIN(RCTScreenSize().width,RCTScreenSize().height);
  //  å®½
  CGFloat height = MAX(RCTScreenSize().width,RCTScreenSize().height);
  //  é«˜
  CGFloat scale = RCTScreenScale();
  //  åƒç´ å¯†åº¦

  if(UIDeviceOrientationIsLandscape([UIDevice currentDevice].orientation)){
    width = MAX(RCTScreenSize().width,RCTScreenSize().height);
    height = MIN(RCTScreenSize().width,RCTScreenSize().height);
  }

  return @{
            @&quot;width&quot;:@(width),
            @&quot;height&quot;:@(height),
            @&quot;scale&quot;:@(scale)
           };
  //  åœ¨å›è°ƒæ–¹æ³•ä¸­ä½œä¸ºä¸€ä¸ªå¯¹è±¡,æœ‰width,height,scaleå±æ€§

}

RCT_EXPORT_METHOD(getDeviceInfo:(RCTResponseSenderBlock)callback){
  callback(@[[NSNull null],DynamicDimesions()]);
};
//  æš´éœ²æ–¹æ³•

@end
</code></pre><p>è¿™é‡ŒOCæš´éœ²ä¸€ä¸ªç±»,DeviceExtension(RCTDeviceExtensionè¢«ç¼–è¯‘æˆDeviceExtension)ï¼Œåœ¨JSç«¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼æ¥è°ƒç”¨ç›¸å…³æ–¹æ³•ã€‚</p>
<pre><code>var DeviceExtension = require(&quot;NativeModules&quot;).DeviceExtension;
//  require(&quot;NativeModules&quot;)ç”¨æ¥åŠ è½½åŸç”Ÿæ¨¡å—(åŒ…æ‹¬è‡ªå®šä¹‰æ¨¡å—)

DeviceExtension.getDeviceInfo(function(err,info){
  console.log(info);
});
</code></pre><p>è¿™æ ·æˆ‘ä»¬çš„è‡ªå®šä¹‰APIå°±å®ç°äº†ï¼Œåé¢å¦‚æœå†æœ‰æ›´å¤æ‚çš„åŠŸèƒ½çš„æ—¶å€™ï¼Œæ€è·¯éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡æ­¥éª¤ä¼šæ›´ç¹æ‚ä¸€äº›ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç°å¦‚ä»Šï¼Œè¶Šæ¥è¶Šå¤šçš„ç§»åŠ¨å¼€å‘è€…é€‰æ‹©ç”¨React Nativeæ¥å¼€å‘ä»–ä»¬çš„appã€‚è™½ç„¶React Nativeæä¾›äº†å¼ºå¤§çš„APIä¾›æˆ‘ä»¬è°ƒç”¨ï¼Œä½†æ˜¯å¯¹äºä¸€äº›åŠŸèƒ½(æ¯”å¦‚ç¬¬ä¸‰æ–¹æ”¯ä»˜ã€æ–‡ä»¶ä¸Šä¼ ä¹‹ç±»çš„)ï¼ŒåŸç”Ÿæ¨¡å—ä¸­å¹¶æ²¡æœ‰æä¾›ç»™æˆ‘ä»¬ç›¸å…³çš„APIï¼Œè¿™æ—¶å€™å°±éœ€è¦æˆ‘ä»¬æ¥è‡ªå·±å°è£…ä¸€äº›ä¸œè¥¿æ¥ç»™jsç«¯è°ƒ
    
    </summary>
    
      <category term="React" scheme="http://yoursite.com/categories/React/"/>
    
    
  </entry>
  
  <entry>
    <title>Reactä¸­çš„å—æ§ç»„ä»¶</title>
    <link href="http://yoursite.com/2016/01/05/2016-01-05-react-controlled-compoent/"/>
    <id>http://yoursite.com/2016/01/05/2016-01-05-react-controlled-compoent/</id>
    <published>2016-01-04T16:00:00.000Z</published>
    <updated>2017-03-31T05:28:25.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¡¨å•æ˜¯webåº”ç”¨ä¸­ä¸å¯ç¼ºå°‘çš„ä¸€éƒ¨åˆ†,ä¸åŒäºå…¶ä»–å…ƒç´ ,è¡¨å•éœ€è¦å“åº”ç”¨æˆ·è¾“å…¥,æ ¹æ®è¾“å…¥å€¼çš„ä¸åŒå“åº”ä¸åŒçš„çŠ¶æ€,ReactåŸºäºpropså’Œstateçš„æ¸²æŸ“æœºåˆ¶,å¯ä»¥å¾ˆå¥½çš„å¤„ç†è¡¨å•ã€‚åœ¨Reactä¸­è¡¨å•åˆ†ä¸ºå—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶ä¸¤ç§ã€‚</p>
<h3 id="å—æ§ç»„ä»¶-å—Reactæ§åˆ¶çš„å€¼"><a href="#å—æ§ç»„ä»¶-å—Reactæ§åˆ¶çš„å€¼" class="headerlink" title="å—æ§ç»„ä»¶ - å—Reactæ§åˆ¶çš„å€¼"></a>å—æ§ç»„ä»¶ - å—Reactæ§åˆ¶çš„å€¼</h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¡¨å•æ˜¯webåº”ç”¨ä¸­ä¸å¯ç¼ºå°‘çš„ä¸€éƒ¨åˆ†,ä¸åŒäºå…¶ä»–å…ƒç´ ,è¡¨å•éœ€è¦å“åº”ç”¨æˆ·è¾“å…¥,æ ¹æ®è¾“å…¥å€¼çš„ä¸åŒå“åº”ä¸åŒçš„çŠ¶æ€,ReactåŸºäºpropså’Œstateçš„æ¸²æŸ“æœºåˆ¶,å¯ä»¥å¾ˆå¥½çš„å¤„ç†è¡¨å•ã€‚åœ¨Reactä¸­è¡¨å•åˆ†ä¸ºå—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶ä¸¤ç§ã€‚&lt;/p&gt;
&lt;h3 id=&quot;å—æ§ç»„ä»¶-å—Reactæ§åˆ¶
    
    </summary>
    
      <category term="React" scheme="http://yoursite.com/categories/React/"/>
    
    
  </entry>
  
</feed>
